1:"$Sreact.fragment"
2:I[99676,["/_next/static/chunks/7c5ef281d3c6aa1b.js","/_next/static/chunks/ef763e11ad9b2e12.js","/_next/static/chunks/0a277c514b971790.js","/_next/static/chunks/f7d70d96044b0f34.js"],"Avatar"]
3:I[99676,["/_next/static/chunks/7c5ef281d3c6aa1b.js","/_next/static/chunks/ef763e11ad9b2e12.js","/_next/static/chunks/0a277c514b971790.js","/_next/static/chunks/f7d70d96044b0f34.js"],"AvatarImage"]
4:I[99676,["/_next/static/chunks/7c5ef281d3c6aa1b.js","/_next/static/chunks/ef763e11ad9b2e12.js","/_next/static/chunks/0a277c514b971790.js","/_next/static/chunks/f7d70d96044b0f34.js"],"AvatarFallback"]
5:I[5500,["/_next/static/chunks/7c5ef281d3c6aa1b.js","/_next/static/chunks/ef763e11ad9b2e12.js","/_next/static/chunks/0a277c514b971790.js","/_next/static/chunks/f7d70d96044b0f34.js"],"Image"]
6:I[52157,["/_next/static/chunks/7c5ef281d3c6aa1b.js","/_next/static/chunks/ef763e11ad9b2e12.js","/_next/static/chunks/0a277c514b971790.js","/_next/static/chunks/f7d70d96044b0f34.js"],"PreloadChunks"]
39:I[22016,["/_next/static/chunks/7c5ef281d3c6aa1b.js","/_next/static/chunks/ef763e11ad9b2e12.js","/_next/static/chunks/0a277c514b971790.js","/_next/static/chunks/f7d70d96044b0f34.js"],""]
3c:I[97367,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/6153d1a363729c2c.js"],"OutletBoundary"]
3d:"$Sreact.suspense"
0:{"buildId":"6Ky4R6Bkx7NelPiZjM_hQ","rsc":["$","$1","c",{"children":[["$","main",null,{"className":"flex-1","children":[["$","script",null,{"type":"application/ld+json","suppressHydrationWarning":true,"dangerouslySetInnerHTML":{"__html":"{\"@context\":\"https://schema.org\",\"@type\":\"BlogPosting\",\"headline\":\"Azure revisited\",\"datePublished\":\"2022-11-21T12:13:08.801Z\",\"dateModified\":\"2022-11-21T12:13:08.801Z\",\"description\":\"A year with Azure has passed, and this is what I have learned.\",\"image\":\"https://sebastian-staffa.eu/images/azure-revisited-header.jpg\",\"url\":\"https://sebastian-staffa.eu/posts/azure-revisited\",\"author\":{\"@type\":\"Person\",\"name\":\"Sebastian Staffa\"}}"}}],["$","article",null,{"className":"container max-w-3xl px-4 py-6 lg:py-12 mx-auto","children":[["$","h1",null,{"className":"text-3xl font-bold tracking-tighter sm:text-4xl md:text-5xl lg:text-6xl/none mb-4","children":"Azure revisited"}],"$undefined",["$","div",null,{"className":"flex items-center space-x-4 mb-4","children":[["$","$L2",null,{"children":[["$","$L3",null,{"src":"/_next/static/media/portrait-ico.088aff86.webp","alt":"Avatar of Sebastian Staffa"}],["$","$L4",null,{"children":"S"}]]}],["$","div",null,{"children":[["$","p",null,{"className":"text-sm font-medium","children":"Sebastian Staffa"}],["$","p",null,{"className":"text-sm text-gray-500 flex flex-row align-baseline","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-calendar inline-block w-4 h-4 mr-1","children":[["$","path","1cmpym",{"d":"M8 2v4"}],["$","path","4m81vk",{"d":"M16 2v4"}],["$","rect","1hopcy",{"width":"18","height":"18","x":"3","y":"4","rx":"2"}],["$","path","8toen8",{"d":"M3 10h18"}],"$undefined"]}],"Published on"," ","Nov 21, 2022, 1:13 PM"]}]]}]]}],["$","$L5",null,{"src":{"src":"/_next/static/media/azure-revisited-header.7f820b91.jpg","width":6000,"height":1970,"blurWidth":8,"blurHeight":3,"blurDataURL":"data:image/jpeg;base64,/9j/4AAQSkZJRgABAgAAAQABAAD/wAARCAADAAgDAREAAhEBAxEB/9sAQwAKBwcIBwYKCAgICwoKCw4YEA4NDQ4dFRYRGCMfJSQiHyIhJis3LyYpNCkhIjBBMTQ5Oz4+PiUuRElDPEg3PT47/9sAQwEKCwsODQ4cEBAcOygiKDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwDk7jULq3srdoZBGzLyVQAnn6VsQf/Z"},"alt":"Photo by Harshit Sharma on Unsplash","className":"rounded-lg object-cover w-full mb-8","priority":true}],["$","div",null,{"className":"prose max-w-none","children":[["$","$L6",null,{}],[["$","p",null,{"children":"You see, I think of myself as someone who is able to admit when he has made a\nmistake. As such, I am not afraid to say that time has proven my initial,\noptimistic evaluation of Azure to be more than wrong."}],"\n",["$","p",null,{"children":"In my first post about this topic I toured the online portal of azure, in which\nI configured a few basic infrastructure building blocks and compared them with\ntheir AWS equivalents. But this approach has a glaring issue: This would not be\nhow Azure would be used in production."}],"\n",["$","p",null,{"children":"In fact, in the best case scenario, I would never have visited the azure portal\never again, because I would have been able to work exclusively via an\ninfrastructure-as-code language. This is how I use AWS at least and this is, in\nmy opinion, the only way how a cloud infrastructure provider can be used in a\nprofessional setting. Without it, one can neither share nor reproduce a cloud\nbased application."}],"\n","$L7","\n","$L8","\n","$L9","\n","$La","\n","$Lb","\n","$Lc","\n","$Ld","\n","$Le","\n","$Lf","\n","$L10","\n","$L11","\n","$L12","\n","$L13","\n","$L14","\n","$L15","\n","$L16","\n","$L17","\n","$L18","\n","$L19","\n","$L1a","\n","$L1b","\n","$L1c","\n","$L1d","\n","$L1e","\n","$L1f","\n","$L20","\n","$L21","\n","$L22","\n","$L23","\n","$L24","\n","$L25","\n","$L26","\n","$L27","\n","$L28","\n","$L29","\n","$L2a"]]}]]}],"$L2b"]}],["$L2c","$L2d"],"$L2e"]}],"loading":null,"isPartial":false}
7:["$","h2",null,{"id":"iac-options-with-azure","children":"IaC Options with Azure"}]
8:["$","p",null,{"children":"After a few test runs of our first Azure-based application in an environment\nthat was created by hand we wanted to prepare the software for production use.\nThe first thing we wanted to do was to consolidate the pieces of infrastructure\nI had manually created into an IaC document. To do so, we had to decide which\nIaC language to use beforehand. At the time of our evaluation we had three\noptions:"}]
9:["$","ol",null,{"children":["\n",["$","li",null,{"children":"ARM templates: A terribly named, verbose, JSON flavour"}],"\n",["$","li",null,{"children":"Bicep templates: A DSL which transpiles into ARM templates"}],"\n",["$","li",null,{"children":"Terraform: A meta IaC language by HashiCorp"}],"\n"]}]
a:["$","p",null,{"children":["ARM templates\n(",["$","a",null,{"href":"https://github.com/Azure/azure-quickstart-templates/blob/521795efc34e79d52b27975fa416c82a3533bb9a/quickstarts/microsoft.web/mobile-app-create/azuredeploy.json","children":"example"}],")\nwere already kinda deprecated when we started, as we were greeted with this\ninfo-box on the ARM start page:"]}]
b:["$","$L5",null,{"src":{"src":"/_next/static/media/bicep-arm-deprecation-warning-2.588be035.png","width":902,"height":203,"blurWidth":8,"blurHeight":2,"blurDataURL":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAACCAIAAADq9gq6AAAAM0lEQVR42k3CUQoAEAwA0F2AJfJBo8ZF5EuT2v0v45N64FZFIdzlETIjQTzdKwdtH7YzX79xB9VZyw4hAAAAAElFTkSuQmCC"},"alt":"A screenshot of the Azure ARM deprecation warning"}]
c:["$","p",null,{"children":"This left us with two candidates: Terraform and Bicep. After some discussion we\nsettled for Bicep because of two reasons: Firstly, we felt that we didn't need\nthe additional abstraction layer that Terraform provided and that we probably\nwould have to break out into ARM or Bicep any way if a certain edge case we\nneeded to address could not be fixed with Terraform. At the same time we would\nnot be able to benefit from the advertised upsides of terraform like the\nmulti-cloud capability as we'd be stuck on Azure. We had also made many positive\nexperiences with AWS Cloudformation/SAM which ultimately led us to believe that\nMicrosoft's solutions could not be that much worse, could it?"}]
d:["$","h2",null,{"id":"documentation","children":"Documentation"}]
e:["$","p",null,{"children":["To illustrate my points about the state of IaC at Azure we'll take a closer look\nat a\n",["$","a",null,{"href":"https://github.com/Azure/azure-quickstart-templates/blob/118f0df56f6eca1d5672963c2bb8907f701ca3f5/quickstarts/microsoft.web/function-app-create-dynamic/main.bicep","children":"simple template"}],"\nfrom the official collection of quickstart templates by Microsoft. To be\nprecise, we'll create a plain function app (which is the\n",["$","a",null,{"href":"https://learn.microsoft.com/en-us/azure/architecture/aws-professional/services#compute","children":"official"}],"\nequivalent of an AWS Lambda function)."]}]
f:["$","p",null,{"children":["As you can see, our cloud primitive \"serverless code runner\" actually consists\nof three resources: A ",["$","code",null,{"children":"Microsoft.Storage/storageAccounts"}],", which provides a\nfilesystem to host our function code, a ",["$","code",null,{"children":"Microsoft.Web/serverfarms"}],", which\ndictates how our code is run: serverless or on a provisioned machine, how many\nnines we can expect when it comes to the uptime and so on, and finally a\n",["$","code",null,{"children":"Microsoft.Web/sites"}]," which contains the settings for our code runner. The\nexample also adds a ",["$","code",null,{"children":"Microsoft.Insights/components"}]," resource to add additional\nlogging, but out of goodwill I'll ignore this one as it is not strictly\nnecessary."]}]
10:["$","p",null,{"children":["Now, lets say you have provisioned your first function app by copying this\ntemplate, and you'd now like to modify it. Maybe you are like me and would like\nto know what the other possible ",["$","code",null,{"children":"serverfarm"}]," tiers are, other than the\n",["$","code",null,{"children":"Dynamic"}],"-tier which is used in ",["$","code",null,{"children":"hostingPlan.sku.tier"}],". So you head on over to\nthe\n",["$","a",null,{"href":"https://learn.microsoft.com/en-us/azure/templates/microsoft.web/2022-03-01/serverfarms?pivots=deployment-language-bicep","children":"reference page for the serverfarm resource"}],"\nand check the structure of a ",["$","code",null,{"children":"SkuDescription"}],":"]}]
11:["$","$L5",null,{"src":{"src":"/_next/static/media/bicep-sku-description.91887e71.png","width":671,"height":426,"blurWidth":8,"blurHeight":5,"blurDataURL":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAIAAAD38zoCAAAAUUlEQVR42iWMyRHAMAgDKSO+sAfG9oP++8uG6AFCC8g5JyLuvaWUJ1Vrpcpay8zAlmLUOVtrMlN7b9LeO+uqShXaD9wdwMMPcDHGwHkKDyAAvJXSDmk1dliDAAAAAElFTkSuQmCC"},"alt":"A screenshot of the SkuDescription of a Microsoft.Web/serverfarms resource"}]
12:["$","p",null,{"children":["We have now learned that ",["$","code",null,{"children":"tier"}]," must be a ",["$","code",null,{"children":"string"}],". That's it. As you have\nprobably already guessed, it cannot be ANY string, as only a few ones from the\ninfinite pool of possible strings are allowed. It would be cool if they'd be\nlisted somewhere on this page."]}]
13:["$","p",null,{"children":["If you check the rest of the attributes you'll see that their descriptions are\nequally useless. Just to name a few additional examples: The description of\n",["$","code",null,{"children":"AppServicePlanProperties.spotExpirationTime"}]," reads\n",["$","code",null,{"children":"The time when the server farm expires. Valid only if it is a spot server farm."}],"\nand it must be a string ",["$","code",null,{"children":"string"}],". So we'll probably have to format this time\nvalues somehow when we need to specify it, but how? Can we simply drop in an\nepoch timestamp? Does it taken an\n",["$","a",null,{"href":"https://en.wikipedia.org/wiki/ISO_8601","children":"ISO-8601"}]," string? Can we use timezones\nor does it have to be in UTC?"]}]
14:["$","p",null,{"children":["There is also the ",["$","code",null,{"children":"AppServicePlanProperties.targetWorkerCount"}]," which dictates\nthe ",["$","code",null,{"children":"Scaling worker count."}]," and must be of type ",["$","code",null,{"children":"int"}],". Can I specify any integer\nvalue, without any restrictions? Are 1073741824 workers possible? Is the worker\ncount dependent on the function tier? How does it relate to the\n",["$","code",null,{"children":"maximumElasticWorkerCount"}],"? What is the default value?"]}]
15:["$","p",null,{"children":["This level of documentation is the norm with all azure resources. Just to make\nsure that this is no fluke, let us head over to the documentation of the\n",["$","code",null,{"children":"Microsoft.Web/sites"}]," resource, which, if you remember, is the equivalent of a\nlambda function and should thus be one of the most used resourcetypes."]}]
16:["$","p",null,{"children":["I am specifically interested in the ",["$","code",null,{"children":"siteConfig.appSettings"}]," options, which are\nreally obscure even in the\n",["$","a",null,{"href":"https://github.com/Azure/azure-quickstart-templates/blob/118f0df56f6eca1d5672963c2bb8907f701ca3f5/quickstarts/microsoft.web/function-app-create-dynamic/main.bicep#L61","children":"example quickstart template"}],":"]}]
17:["$","pre",null,{"className":"language-bicep","children":["$","code",null,{"className":"language-bicep code-highlight","children":[["$","span",null,{"className":"code-line","children":["appSettings",["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token punctuation","children":"["}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["      ",["$","span",null,{"className":"token property","children":"name"}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token string","children":"'AzureWebJobsStorage'"}],"\n"]}],["$","span",null,{"className":"code-line","children":["      ",["$","span",null,{"className":"token property","children":"value"}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token interpolated-string","children":[["$","span",null,{"className":"token string","children":"'DefaultEndpointsProtocol=https;AccountName="}],["$","span",null,{"className":"token interpolation","children":[["$","span",null,{"className":"token punctuation","children":"$${"}],["$","span",null,{"className":"token expression","children":"storageAccountName"}],["$","span",null,{"className":"token punctuation","children":"}"}]]}],["$","span",null,{"className":"token string","children":";EndpointSuffix="}],["$","span",null,{"className":"token interpolation","children":[["$","span",null,{"className":"token punctuation","children":"$${"}],["$","span",null,{"className":"token expression","children":[["$","span",null,{"className":"token function","children":"environment"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"."}],"suffixes",["$","span",null,{"className":"token punctuation","children":"."}],"storage"]}],["$","span",null,{"className":"token punctuation","children":"}"}]]}],["$","span",null,{"className":"token string","children":";AccountKey="}],["$","span",null,{"className":"token interpolation","children":[["$","span",null,{"className":"token punctuation","children":"$${"}],["$","span",null,{"className":"token expression","children":["storageAccount",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"listKeys"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"."}],"keys",["$","span",null,{"className":"token punctuation","children":"["}],["$","span",null,{"className":"token number","children":"0"}],["$","span",null,{"className":"token punctuation","children":"]"}],["$","span",null,{"className":"token punctuation","children":"."}],"value"]}],["$","span",null,{"className":"token punctuation","children":"}"}]]}],["$","span",null,{"className":"token string","children":"'"}]]}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["      ",["$","span",null,{"className":"token property","children":"name"}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token string","children":"'WEBSITE_CONTENTAZUREFILECONNECTIONSTRING'"}],"\n"]}],["$","span",null,{"className":"code-line","children":["      ",["$","span",null,{"className":"token property","children":"value"}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token interpolated-string","children":[["$","span",null,{"className":"token string","children":"'DefaultEndpointsProtocol=https;AccountName="}],["$","span",null,{"className":"token interpolation","children":[["$","span",null,{"className":"token punctuation","children":"$${"}],["$","span",null,{"className":"token expression","children":"storageAccountName"}],["$","span",null,{"className":"token punctuation","children":"}"}]]}],["$","span",null,{"className":"token string","children":";EndpointSuffix="}],["$","span",null,{"className":"token interpolation","children":[["$","span",null,{"className":"token punctuation","children":"$${"}],["$","span",null,{"className":"token expression","children":[["$","span",null,{"className":"token function","children":"environment"}],"$L2f","$L30","$L31","suffixes","$L32","storage"]}],"$L33"]}],"$L34","$L35","$L36"]}],"\n"]}],"$L37","$L38"]}]}]
18:["$","p",null,{"children":["How does this ",["$","code",null,{"children":"WEBSITE_CONTENTAZUREFILECONNECTIONSTRING"}]," work? What are the\nother possible ",["$","code",null,{"children":"appSettings"}],"? Which are required and what are the default values\nfor those that are not? Let's check the documentation!"]}]
19:["$","$L5",null,{"src":{"src":"/_next/static/media/bicep-appSettings.6e1414f6.png","width":832,"height":675,"blurWidth":8,"blurHeight":6,"blurDataURL":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAGCAYAAAD+Bd/7AAAAlUlEQVR42jWOOQ7CMBBF3SRp3Fmy8b7KPkNKzsKhuBRXIcItCA1jRxSj2d7/M6S1BiF4UEqBc25mrTUIIZ7LsuwkhAAeF8YYqLVCSgmstRNY13Un3p/qPxBjBGMdXKQ6ARx8hmIApRQYggEoZY5t266Ec35H5TfnPH+QUuJSD9c3Y+xBKKU3bA6Mji4db3eE+uixfv0Aah05wDiYFbsAAAAASUVORK5CYII="},"alt":""}]
1a:["$","h2",null,{"id":"deployment","children":"Deployment"}]
1b:["$","p",null,{"children":"Now, Azure wouldn't be the first, nor the last tool where the documentation is\nunusable. There is always the try-and-fail method. Let's just throw together a\nsimple deployment, run it, and see what the errors are."}]
1c:["$","p",null,{"children":"There are two basic problems with this approach when working with Azure. To\nbegin with, most deployments take ages. You'll want to provision a new\nserverless mssql database? Come back in 40 minutes. You'll need an API\nManagement instance? That'll also set you back like 40 minutes. But don't worry,\nwe'll send you an emails when it's ready."}]
1d:["$","$L5",null,{"src":{"src":"/_next/static/media/bicep-email-edit.2d5b9533.png","width":1069,"height":413,"blurWidth":8,"blurHeight":3,"blurDataURL":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAADCAYAAACuyE5IAAAARUlEQVR42l2KQQqAMAwE+/+nligxYFMl2TUVvDgwh2WnmRlFNqhqujsykx8RyaaHsXdhhVhByXnddQYBsO06eI75jr+LBwYKXbtJoqCgAAAAAElFTkSuQmCC"},"alt":""}]
1e:["$","p",null,{"children":"Now, let's assume the deployment did not work and after around half an hour you\nreceive an error message. After all this time you've spent waiting, it surely is\ndetailed and allows you to fix the problems with your template right? Well, I've\ncompiled some examples for you:"}]
1f:["$","$L5",null,{"src":{"src":"/_next/static/media/bicep-error-compilation.6d0c761c.png","width":897,"height":301,"blurWidth":8,"blurHeight":3,"blurDataURL":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAADCAYAAACuyE5IAAAAY0lEQVR42h2MvQqAIBRGHXuHRn1U6ULPEkHQJL2Bk0ERRLPQKA0q/nS9B87y8XFYjxhjzhhjTSnVnHM9rvvhXIgOYQAwWmvfdgghkM65Tym1TfOyMu89jaUUKmitdykloEPzB4KTR7gc6Q4uAAAAAElFTkSuQmCC"},"alt":""}]
20:["$","h2",null,{"id":"degradation","children":"Degradation"}]
21:["$","p",null,{"children":"For the last point I'd like to make I can only offer anecdotal evidence, as this\nincident only happened once, but this was enough to get me worried."}]
22:["$","p",null,{"children":"In a resource stack we had deployed on our production system we had a resource\nwhich looked like this"}]
23:["$","pre",null,{"className":"language-bicep","children":["$","code",null,{"className":"language-bicep code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token keyword","children":"resource"}]," appservicePlan ",["$","span",null,{"className":"token string","children":"'Microsoft.Web/serverfarms@2021-03-01'"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token property","children":"name"}],["$","span",null,{"className":"token operator","children":":"}]," appservice_plan_name\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token property","children":"location"}],["$","span",null,{"className":"token operator","children":":"}]," location\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token property","children":"tags"}],["$","span",null,{"className":"token operator","children":":"}]," tag_values\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token property","children":"sku"}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token property","children":"name"}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token string","children":"'Y1'"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token property","children":"tier"}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token string","children":"'Dynamic'"}],"\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}]]}]}]
24:["$","p",null,{"children":"This stack was deployed and updated countless times between our production and\nstaging/test environments and we never encountered a problem with it. Through a\nbit of a lull in the development (it was the holiday season) changes to the\nsystem slowed down, and we did not run a deployment for a few weeks."}]
25:["$","p",null,{"children":["When work resumed in earnest, the resource group could not be deployed anymore.\nAzure helpfully reported ",["$","code",null,{"children":"Object reference not set to an instance of an object."}],"\nand that was it. We had to try and fail our way through the deployment, removing\nresources until it worked, until be determined that the resource that is show\nabove is the culprit. This confused us to no small amount, as this resource had\nbeen in the stack for months, and it never caused any issues."]}]
26:["$","p",null,{"children":["In the end we found out that we had to add the attribute ",["$","code",null,{"children":"kind: 'linux'"}]," to the\n",["$","code",null,{"children":"appservicePlan"}],". This got the deployment working again, but if this really was\nthe root cause of the issue or if it can occur again some other time, that we\ndon't know. It does not really look like it is required, as there are official\nexamples about (like the one I\n",["$","a",null,{"href":"https://github.com/Azure/azure-quickstart-templates/blob/118f0df56f6eca1d5672963c2bb8907f701ca3f5/quickstarts/microsoft.web/function-app-create-dynamic/main.bicep#L41","children":"linked above"}],")\nwhich seem to work without this attribute."]}]
27:["$","h2",null,{"id":"conclusion","children":"Conclusion"}]
28:["$","p",null,{"children":"After you've read about all the trouble we had with Azure and Bicep/ARM you\npropably understand why I had to come back to the topic and correct my initial\nconclusions about the platform."}]
29:["$","p",null,{"children":"To be clear: After all these experiences I'll probably try to avoid Azure for\nsome time. In my opinion, a cloud platform without a reliable, well documented\nIaC language really is not usable for any production use-case."}]
2a:["$","p",null,{"children":"You may now argue that we should have used Terraform or something else from the\nbeginning and that the platform Azure cannot be judged by the performance of\nit's IaC language, but I really cannot let that one count. When the official,\nsupported and advertised way of doing infrastructure-as-code on a platform does\nnot work, then they should not advertise it, and it becomes a flaw of the\nplatform. We can argue about runtime and maybe even documentation, but if you\nadvertise a way of doing things it should AT LEAST work reliably."}]
2b:["$","section",null,{"className":"w-full py-12 md:py-24 lg:py-32 bg-gray-100 dark:bg-gray-800","children":["$","div",null,{"className":"container px-4 md:px-6 mx-auto","children":[["$","h2",null,{"className":"text-3xl font-bold tracking-tighter sm:text-5xl text-center mb-4 md:mb-6","children":"More posts like this one"}],["$","div",null,{"className":"grid gap-6 md:grid-cols-2 lg:grid-cols-3","children":[["$","div","nodejs-native-ts-benchmark",{"className":"rounded-xl border bg-card text-card-foreground shadow flex flex-col justify-between","children":[["$","div",null,{"className":"flex flex-col space-y-1.5 p-6","children":[["$","h3",null,{"className":"font-semibold leading-none tracking-tight","children":["$","$L39",null,{"href":"/posts/nodejs-native-ts-benchmark","children":"A look at native TypeScript performance"}]}],["$","div",null,{"className":"flex items-center space-x-1 text-sm text-gray-500","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-calendar h-4 w-4","children":[["$","path","1cmpym",{"d":"M8 2v4"}],["$","path","4m81vk",{"d":"M16 2v4"}],["$","rect","1hopcy",{"width":"18","height":"18","x":"3","y":"4","rx":"2"}],["$","path","8toen8",{"d":"M3 10h18"}],"$undefined"]}],["$","time",null,{"dateTime":"2025-02-24T14:32:53.120Z","children":"Feb 24, 2025, 3:32 PM"}]]}]]}],["$","div",null,{"className":"p-6 pt-0","children":["$","p",null,{"children":"Node.js 23.6.0 dropped the experimental flag for native TypeScript support. Let's see how it performs when running TS natively."}]}],["$","div",null,{"className":"items-center p-6 pt-0 flex justify-between","children":[["$","p",null,{"className":"text-sm text-gray-500","children":["By ","Sebastian Staffa"]}],["$","$L39",null,{"href":"/posts/nodejs-native-ts-benchmark","children":["$","button",null,{"className":"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 text-primary underline-offset-4 hover:underline h-9 px-4 py-2","children":["Read More",["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-chevron-right ml-2 h-4 w-4","children":[["$","path","mthhwq",{"d":"m9 18 6-6-6-6"}],"$undefined"]}]]}]}]]}]]}],["$","div","note-on-nixos-handeling-feedback",{"className":"rounded-xl border bg-card text-card-foreground shadow flex flex-col justify-between","children":[["$","div",null,{"className":"flex flex-col space-y-1.5 p-6","children":[["$","h3",null,{"className":"font-semibold leading-none tracking-tight","children":["$","$L39",null,{"href":"/posts/note-on-nixos-handeling-feedback","children":"Note: NixOS Feedback Handling"}]}],["$","div",null,{"className":"flex items-center space-x-1 text-sm text-gray-500","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-calendar h-4 w-4","children":[["$","path","1cmpym",{"d":"M8 2v4"}],["$","path","4m81vk",{"d":"M16 2v4"}],["$","rect","1hopcy",{"width":"18","height":"18","x":"3","y":"4","rx":"2"}],["$","path","8toen8",{"d":"M3 10h18"}],"$undefined"]}],["$","time",null,{"dateTime":"2025-01-13T13:26:51.295Z","children":"Jan 13, 2025, 2:26 PM"}]]}]]}],["$","div",null,{"className":"p-6 pt-0","children":["$","p",null,{"children":"A quick, positive example on how a project can handle critical feedback"}]}],["$","div",null,{"className":"items-center p-6 pt-0 flex justify-between","children":[["$","p",null,{"className":"text-sm text-gray-500","children":["By ","Sebastian Staffa"]}],["$","$L39",null,{"href":"/posts/note-on-nixos-handeling-feedback","children":["$","button",null,{"className":"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 text-primary underline-offset-4 hover:underline h-9 px-4 py-2","children":["Read More","$L3a"]}]}]]}]]}],"$L3b"]}]]}]}]
2c:["$","script","script-0",{"src":"/_next/static/chunks/0a277c514b971790.js","async":true}]
2d:["$","script","script-1",{"src":"/_next/static/chunks/f7d70d96044b0f34.js","async":true}]
2e:["$","$L3c",null,{"children":["$","$3d",null,{"name":"Next.MetadataOutlet","children":"$@3e"}]}]
2f:["$","span",null,{"className":"token punctuation","children":"("}]
30:["$","span",null,{"className":"token punctuation","children":")"}]
31:["$","span",null,{"className":"token punctuation","children":"."}]
32:["$","span",null,{"className":"token punctuation","children":"."}]
33:["$","span",null,{"className":"token punctuation","children":"}"}]
34:["$","span",null,{"className":"token string","children":";AccountKey="}]
35:["$","span",null,{"className":"token interpolation","children":[["$","span",null,{"className":"token punctuation","children":"$${"}],["$","span",null,{"className":"token expression","children":["storageAccount",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"listKeys"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"."}],"keys",["$","span",null,{"className":"token punctuation","children":"["}],["$","span",null,{"className":"token number","children":"0"}],["$","span",null,{"className":"token punctuation","children":"]"}],["$","span",null,{"className":"token punctuation","children":"."}],"value"]}],["$","span",null,{"className":"token punctuation","children":"}"}]]}]
36:["$","span",null,{"className":"token string","children":"'"}]
37:["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}]
38:["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token comment","children":"//..."}],"\n"]}]
3a:["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-chevron-right ml-2 h-4 w-4","children":[["$","path","mthhwq",{"d":"m9 18 6-6-6-6"}],"$undefined"]}]
3b:["$","div","minimal-lambda-containers-with-nix",{"className":"rounded-xl border bg-card text-card-foreground shadow flex flex-col justify-between","children":[["$","div",null,{"className":"flex flex-col space-y-1.5 p-6","children":[["$","h3",null,{"className":"font-semibold leading-none tracking-tight","children":["$","$L39",null,{"href":"/posts/minimal-lambda-containers-with-nix","children":"Improving Median Lambda Init Times By 23%"}]}],["$","div",null,{"className":"flex items-center space-x-1 text-sm text-gray-500","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-calendar h-4 w-4","children":[["$","path","1cmpym",{"d":"M8 2v4"}],["$","path","4m81vk",{"d":"M16 2v4"}],["$","rect","1hopcy",{"width":"18","height":"18","x":"3","y":"4","rx":"2"}],["$","path","8toen8",{"d":"M3 10h18"}],"$undefined"]}],["$","time",null,{"dateTime":"2024-12-09T11:56:02.178Z","children":"Dec 9, 2024, 12:56 PM"}]]}]]}],["$","div",null,{"className":"p-6 pt-0","children":["$","p",null,{"children":"In today's post we are improving the cold start times of a Node.js Lambda function by building our own runtime image using Nix."}]}],["$","div",null,{"className":"items-center p-6 pt-0 flex justify-between","children":[["$","p",null,{"className":"text-sm text-gray-500","children":["By ","Sebastian Staffa"]}],["$","$L39",null,{"href":"/posts/minimal-lambda-containers-with-nix","children":["$","button",null,{"className":"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 text-primary underline-offset-4 hover:underline h-9 px-4 py-2","children":["Read More",["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-chevron-right ml-2 h-4 w-4","children":[["$","path","mthhwq",{"d":"m9 18 6-6-6-6"}],"$undefined"]}]]}]}]]}]]}]
3e:null
