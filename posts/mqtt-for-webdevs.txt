3:"$Sreact.fragment"
4:I[231,["411","static/chunks/411-9de8eb5daa65ab56.js","173","static/chunks/173-6cd06f1afb934c1c.js","376","static/chunks/376-dcd9863a661069d6.js","231","static/chunks/231-b6ed7b656f47d0fa.js","66","static/chunks/66-8c94170eb044c122.js","333","static/chunks/app/posts/%5Bslug%5D/page-a0970cff076b21c5.js"],""]
5:I[39275,[],""]
6:I[61343,[],""]
7:I[25361,["411","static/chunks/411-9de8eb5daa65ab56.js","231","static/chunks/231-b6ed7b656f47d0fa.js","185","static/chunks/app/layout-92665f9ab19205d6.js"],"default",1]
9:I[53120,[],"OutletBoundary"]
b:I[53120,[],"MetadataBoundary"]
d:I[53120,[],"ViewportBoundary"]
f:I[76130,[],""]
1:HL["/_next/static/media/d4834662e8b5d3f9-s.p.ttf","font",{"crossOrigin":"","type":"font/ttf"}]
2:HL["/_next/static/css/8164ca3aa7e3e5ba.css","style"]
0:{"P":null,"b":"sCyrSEHaGHZWlJRdfozgc","p":"","c":["","posts","mqtt-for-webdevs"],"i":false,"f":[[["",{"children":["posts",{"children":[["slug","mqtt-for-webdevs","d"],{"children":["__PAGE__?{\"slug\":\"mqtt-for-webdevs\"}",{}]}]}]},"$undefined","$undefined",true],["",["$","$3","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/8164ca3aa7e3e5ba.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","className":"__variable_4eb141","children":["$","body",null,{"children":["$","div",null,{"className":"flex flex-col min-h-screen","children":[["$","header",null,{"className":"px-4 lg:px-6 h-14 flex items-center","children":[["$","$L4",null,{"className":"flex items-center justify-center","href":"/","children":[["$","svg",null,{"ref":"$undefined","xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-book-open h-6 w-6","children":[["$","path","1akyts",{"d":"M12 7v14"}],["$","path","ruj8y",{"d":"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"}],"$undefined"]}],["$","span",null,{"className":"sr-only","children":"Blog"}]]}],["$","nav",null,{"className":"ml-auto flex gap-4 sm:gap-6","children":[["$","$L4",null,{"className":"text-sm font-medium hover:underline underline-offset-4","href":"/","children":"Home"}],["$","$L4",null,{"className":"text-sm font-medium hover:underline underline-offset-4","href":"/contact","children":"Contact"}],["$","$L4",null,{"className":"text-sm font-medium hover:underline underline-offset-4","href":"/posts","children":"Blog"}]]}]]}],["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[]}],["$","$L7",null,{}],["$","footer",null,{"className":"flex flex-col gap-2 sm:flex-row py-6 w-full shrink-0 items-center px-4 md:px-6 border-t","children":[["$","p",null,{"className":"text-xs text-gray-500 dark:text-gray-400","children":["Â© ",2025," Sebastian Staffa."]}],["$","nav",null,{"className":"sm:ml-auto flex gap-4 sm:gap-6","children":[["$","$L4",null,{"className":"text-xs hover:underline underline-offset-4","href":"/feed.rss","prefetch":false,"children":"RSS"}],["$","$L4",null,{"className":"text-xs hover:underline underline-offset-4","href":"/imprint","children":"Imprint"}]]}]]}]]}]}]}]]}],{"children":["posts",["$","$3","c",{"children":[null,["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]]}],{"children":[["slug","mqtt-for-webdevs","d"],["$","$3","c",{"children":[null,["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children","$0:f:0:1:2:children:2:children:0","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]]}],{"children":["__PAGE__",["$","$3","c",{"children":["$L8",null,["$","$L9",null,{"children":"$La"}]]}],{},null]},null]},null]},null],["$","$3","h",{"children":[null,["$","$3","lI56rfWlfcXQM1w0hOu23",{"children":[["$","$Lb",null,{"children":"$Lc"}],["$","$Ld",null,{"children":"$Le"}],["$","meta",null,{"name":"next-size-adjust"}]]}]]}]]],"m":"$undefined","G":"$f","s":false,"S":true}
10:I[43421,["411","static/chunks/411-9de8eb5daa65ab56.js","173","static/chunks/173-6cd06f1afb934c1c.js","376","static/chunks/376-dcd9863a661069d6.js","231","static/chunks/231-b6ed7b656f47d0fa.js","66","static/chunks/66-8c94170eb044c122.js","333","static/chunks/app/posts/%5Bslug%5D/page-a0970cff076b21c5.js"],"Avatar",1]
11:I[43421,["411","static/chunks/411-9de8eb5daa65ab56.js","173","static/chunks/173-6cd06f1afb934c1c.js","376","static/chunks/376-dcd9863a661069d6.js","231","static/chunks/231-b6ed7b656f47d0fa.js","66","static/chunks/66-8c94170eb044c122.js","333","static/chunks/app/posts/%5Bslug%5D/page-a0970cff076b21c5.js"],"AvatarImage",1]
12:I[43421,["411","static/chunks/411-9de8eb5daa65ab56.js","173","static/chunks/173-6cd06f1afb934c1c.js","376","static/chunks/376-dcd9863a661069d6.js","231","static/chunks/231-b6ed7b656f47d0fa.js","66","static/chunks/66-8c94170eb044c122.js","333","static/chunks/app/posts/%5Bslug%5D/page-a0970cff076b21c5.js"],"AvatarFallback",1]
13:I[38173,["411","static/chunks/411-9de8eb5daa65ab56.js","173","static/chunks/173-6cd06f1afb934c1c.js","376","static/chunks/376-dcd9863a661069d6.js","231","static/chunks/231-b6ed7b656f47d0fa.js","66","static/chunks/66-8c94170eb044c122.js","333","static/chunks/app/posts/%5Bslug%5D/page-a0970cff076b21c5.js"],"Image"]
14:I[85025,["411","static/chunks/411-9de8eb5daa65ab56.js","173","static/chunks/173-6cd06f1afb934c1c.js","376","static/chunks/376-dcd9863a661069d6.js","231","static/chunks/231-b6ed7b656f47d0fa.js","66","static/chunks/66-8c94170eb044c122.js","333","static/chunks/app/posts/%5Bslug%5D/page-a0970cff076b21c5.js"],"PreloadChunks"]
8:["$","main",null,{"className":"flex-1","children":[["$","script",null,{"type":"application/ld+json","suppressHydrationWarning":true,"dangerouslySetInnerHTML":{"__html":"{\"@context\":\"https://schema.org\",\"@type\":\"BlogPosting\",\"headline\":\"MQTT For Web Developers\",\"datePublished\":\"2024-11-20T16:13:52.889Z\",\"dateModified\":\"2024-11-20T16:13:52.889Z\",\"description\":\"MQTT is a protocol that is typically used in an IoT context. In this article, we'll explore how we could use its capabilities in a traditional web application to stream messages in real-time.\",\"image\":\"https://sebastian-staffa.eu/images/happy-mqtt-big.webp\",\"url\":\"https://sebastian-staffa.eu/posts/mqtt-for-webdevs\",\"author\":{\"@type\":\"Person\",\"name\":\"Sebastian Staffa\"}}"}}],["$","article",null,{"className":"container max-w-3xl px-4 py-6 lg:py-12 mx-auto","children":[["$","h1",null,{"className":"text-3xl font-bold tracking-tighter sm:text-4xl md:text-5xl lg:text-6xl/none mb-4","children":"MQTT For Web Developers"}],"$undefined",["$","div",null,{"className":"flex items-center space-x-4 mb-4","children":[["$","$L10",null,{"children":[["$","$L11",null,{"src":"/_next/static/media/portrait-ico.778fd454.webp","alt":"Avatar of Sebastian Staffa"}],["$","$L12",null,{"children":"S"}]]}],["$","div",null,{"children":[["$","p",null,{"className":"text-sm font-medium","children":"Sebastian Staffa"}],["$","p",null,{"className":"text-sm text-gray-500 flex flex-row align-baseline","children":[["$","svg",null,{"ref":"$undefined","xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-calendar inline-block w-4 h-4 mr-1","children":[["$","path","1cmpym",{"d":"M8 2v4"}],["$","path","4m81vk",{"d":"M16 2v4"}],["$","rect","1hopcy",{"width":"18","height":"18","x":"3","y":"4","rx":"2"}],["$","path","8toen8",{"d":"M3 10h18"}],"$undefined"]}],"Published on"," ","Nov 20, 2024, 5:13 PM"]}]]}]]}],["$","$L13",null,{"src":{"src":"/_next/static/media/happy-mqtt-big.a9198661.webp","height":1024,"width":2048,"blurDataURL":"data:image/webp;base64,UklGRkIAAABXRUJQVlA4IDYAAADQAQCdASoIAAQAAkA4JZgCdAEO/gOOAAD+6zB/763E6gXPZBpTXmX+VpcRm117+XWXkeyJQAA=","blurWidth":8,"blurHeight":4},"alt":"An illustration of a happy cellular tower, generated by OpenAI's GPT-4o","className":"rounded-lg object-cover w-full mb-8","priority":true}],["$","div",null,{"className":"prose max-w-none","children":[["$","$L14",null,{"moduleIds":"$undefined"}],"$L15"]}]]}],"$L16"]}]
15:[["$","h2",null,{"id":"what-is-this-about","children":"What is this about?"}],"\n",["$","p",null,{"children":["During this year's ",["$","a",null,{"href":"https://www.unkonf.de","children":"unKonf"}],", an\n",["$","a",null,{"href":"https://en.wikipedia.org/wiki/Unconference","children":"unconference"}]," taking place in the\nGerman city of Mannheim, I prepared a quick talk about MQTT and how it could be\nused in web applications. This article is a written, improved version of this\ntalk, taking into account all the feedback that I received."]}],"\n",["$","p",null,{"children":"The Message Queuing Telemetry Transport protocol, or MQTT for short, is a\nprotocol that delivers messages between clients via a central broker. It was\ninitially designed for low-bandwidth, high-latency networks (like cellular) to\nbe used directly on top of TCP, and optimized for clients with low storage and\ncomputing capabilities (like embedded devices) but can also be used on top of\nWebsockets. This enables us to use MQTT in traditional web applications."}],"\n",["$","p",null,{"children":["This article will focus on exactly that by designing a chat application using\nMQTT 3.1.1 as a practical example. I've also implemented this app using\n",["$","a",null,{"href":"https://www.npmjs.com/package/mqtt","children":"mqtt.js"}],", ",["$","a",null,{"href":"https://react.dev/","children":"react"}],",\n",["$","a",null,{"href":"https://ui.shadcn.com/","children":"shadcn"}],", ",["$","a",null,{"href":"https://tailwindcss.com/","children":"tailwind"}]," and the\n",["$","a",null,{"href":"https://redux-toolkit.js.org/","children":"redux-toolkit"}]," to build the frontend and\n",["$","a",null,{"href":"https://mosquitto.org/","children":"mosquitto"}]," as the MQTT broker. You can check out the\nrepository ",["$","a",null,{"href":"https://github.com/Staff-d/mqtt-chat","children":"here"}]," if you want to play\nalong, but I have also included screen recordings of the app at the end of every\nchapter."]}],"\n",["$","h2",null,{"id":"why-should-you-care","children":"Why should you care?"}],"\n",["$","p",null,{"children":"MQTT comes with many features that allow its users to build robust and scalable\nmessaging systems without writing any backend code. Features provided by the\nprotocol include the ability for clients to selectively choose messages relevant\nto them at any given time and the option to define a measure of importance for\neach message, controlling how hard all participants should try to deliver it.\nThe websocket operation mode allows us to integrate it directly into web\napplications, making it ideal for building systems that display various types of\nreal-time information from multiple sources to many clients simultaneously."}],"\n",["$","h2",null,{"id":"mqtt-basics","children":"MQTT Basics"}],"\n",["$","p",null,{"children":"MQTT governs the communication between message senders, a central broker that\ndistributes these messages, and message receivers. There are no direct\nconnections between MQTT clients: Every message is proxied via the broker."}],"\n",["$","p",null,{"children":["Every MQTT connection starts with a ",["$","code",null,{"children":"connect"}]," handshake between a client and the\nbroker. The simplest form of this handshake does not contain much besides a\nsession identifier to identify the running session."]}],"\n",["$","p",null,{"children":["After a connection is established, the server periodically sends pings to the\nclient to determine whether the client is still alive. The interval in which\nthese pings are sent can be configured by the client with the ",["$","code",null,{"children":"connect"}]," package."]}],"\n",["$","h2",null,{"id":"sending-and-receiving-messages","children":"Sending And Receiving Messages"}],"\n",["$","p",null,{"children":["When clients want to send a message, they can send a ",["$","code",null,{"children":"publish"}]," package to the\nbroker. This package contains the message payload and is addressed to a topic.\nTopics are hierarchical strings and, similar to a file path, separated by\nslashes, e.g. ",["$","code",null,{"children":"room/hallway/temperature"}],"."]}],"\n",["$","p",null,{"children":["The message is then forwarded by the broker to all clients that are subscribed\nto this topic. A client subscribes to a topic by sending a ",["$","code",null,{"children":"subscribe"}]," message\nto the broker that either contains a topic or a topic pattern. A topic pattern\ncan contain two different kinds of wildcard characters: ",["$","code",null,{"children":"+"}]," and ",["$","code",null,{"children":"#"}],". The ",["$","code",null,{"children":"+"}],"\ncharacter matches exactly one level of the topic hierarchy and can be used\nmultiple times, while the ",["$","code",null,{"children":"#"}]," character matches any number of levels and must be\nthe last character of a pattern string. Both wildcards can only match a complete\nlevel of the topic hierarchy, which means that ",["$","code",null,{"children":"room/hall+"}]," would be an invalid\npattern. The following subscription patterns would match the message sent to the\ntopic ",["$","code",null,{"children":"room/hallway/temperature"}],":"]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"code-highlight","children":[["$","span",null,{"className":"code-line","children":"// Examples of VALID patterns that match room/hallway/temperature\n"}],["$","span",null,{"className":"code-line","children":"// Complete topic\n"}],["$","span",null,{"className":"code-line","children":"room/hallway/temperature\n"}],["$","span",null,{"className":"code-line","children":"// One single level wildcard\n"}],["$","span",null,{"className":"code-line","children":"room/hallway/+\n"}],["$","span",null,{"className":"code-line","children":"// One single level wildcard that matches every temperature topic\n"}],["$","span",null,{"className":"code-line","children":"room/+/temperature\n"}],["$","span",null,{"className":"code-line","children":"// Two single level wildcards that match every message in every room\n"}],["$","span",null,{"className":"code-line","children":"room/+/+\n"}],["$","span",null,{"className":"code-line","children":"// Three single level wildcards that match every message sent on the broker\n"}],["$","span",null,{"className":"code-line","children":"// with three hierarchy levels\n"}],["$","span",null,{"className":"code-line","children":"+/+/+\n"}],["$","span",null,{"className":"code-line","children":"// Multilevel wildcard for all topics that start with room/\n"}],["$","span",null,{"className":"code-line","children":"room/#\n"}],["$","span",null,{"className":"code-line","children":"// The single multilevel wildcard matches all topics on a broker\n"}],["$","span",null,{"className":"code-line","children":"#\n"}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":"// Examples of INVALID patterns\n"}],["$","span",null,{"className":"code-line","children":"// A multilevel wildcard is not last character of the pattern\n"}],["$","span",null,{"className":"code-line","children":"room/#/temperature\n"}],["$","span",null,{"className":"code-line","children":"// Multiple multilevel wildcards are not allowed\n"}],["$","span",null,{"className":"code-line","children":"room/#/#\n"}],["$","span",null,{"className":"code-line","children":"// Wildcards can only be used to match complete levels\n"}],["$","span",null,{"className":"code-line","children":"room/hall+/temperature\n"}]]}]}],"\n",["$","p",null,{"children":"With these three building blocks (a session identifier, the publish and\nsubscribe commands) we can build a simple chat application. This application\nwould work as follows:"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"A user can choose any username, which the application will use as the MQTT\nsession identifier (this will be important later)"}],"\n",["$","li",null,{"children":["By convention, a user can send messages to any other user by publishing a\nmessage to the topic ",["$","code",null,{"children":"chat/messages/[receiver]/[sender]"}]]}],"\n",["$","li",null,{"children":["To receive messages, a user subscribes to the topic\n",["$","code",null,{"children":"chat/messages/[username]/+"}]," to get all the messages that are addressed to\nthemselves."]}],"\n"]}],"\n",["$","p",null,{"children":["If you are running the ",["$","a",null,{"href":"https://github.com/Staff-d/mqtt-chat","children":"demo"}]," application,\nyou can try out this first implementation of our chat app by navigating to\n",["$","a",null,{"href":"http://localhost:5173/?stage=10","children":["$","code",null,{"children":"http://localhost:5173/?stage=10"}]}]," and\nentering any name to login and start chatting."]}],"\n",["$","video",null,{"controls":true,"preload":"metadata","muted":true,"loop":true,"className":"w-full","children":[["$","source",null,{"src":"/videos/stage-10-fast.webm","type":"video/webm"}],["$","p",null,{"children":"Your browser does not support the video tag."}]]}],"\n",["$","h2",null,{"id":"quality-of-service-qos","children":"Quality of Service (QoS)"}],"\n",["$","p",null,{"children":"When a message is published to a MQTT topic, the sender can specify a Quality of\nService (QoS) level. When a client subscribes to a topic, a QoS value can also\nbe specified which determines the maximum QoS level that is delivered to this\nsubscription. Colloquially speaking, the QoS value determines how hard the MQTT\nbroker should try to deliver the message: the higher the QoS, the harder the\nbroker tries. If the QoS level of a subscription is lower than the QoS level of\na message that should be sent to a subscription, the broker downgrades the QoS\nof the message to match the one of the subscription."}],"\n",["$","p",null,{"children":["Before we take a look at the different QoS levels, it is important to talk about\nthe definition of \"delivering\" a message. In the MQTT-sense, a message is\nconsidered to be delivered when the sender has tried its best to send the\nmessage (in the case of QoS0) or after the package has been acknowledged via\nsome kind of ",["$","code",null,{"children":"ack"}]," packet (in the case of QoS1/2). As both of these actions\noccur before the data is passed to the receiving application, MQTT cannot manage\nmessage ",["$","strong",null,{"children":"processing"}],". If the client crashes immediately after receiving the\nmessage, the message is still considered delivered. This is different from other\nmessage queuing systems, such as RabbitMQ, where messages can be redelivered if\nthe processing of the message failed."]}],"\n",["$","h3",null,{"id":"qos-0-deliver-at-most-once","children":"QoS 0: Deliver At Most Once"}],"\n",["$","p",null,{"children":"QoS 0 is the default value for many MQTT clients when publishing a message. On\nthis level, the message is delivered in a best effort fashion, but both the\nclient and broker can to drop the message if they cannot deliver it on the first\ntry for any reason. Typical cases when messages are dropped are when the client\nis offline, the network is congested or the broker is overloaded."}],"\n",["$","p",null,{"children":"In our chat application we could use QoS 0 for informational messages, like the\ninformation about when a user comes online or goes offline. We won't implement\nthis right away, but keep this in mind for later."}],"\n",["$","h3",null,{"id":"qos-1-deliver-at-least-once","children":"QoS 1: Deliver At Least Once"}],"\n",["$","p",null,{"children":["At QoS 1, the published message is delivered at least once, but may be delivered\nmultiple times. At this level, many client libraries implement a message queue\nto keep track of the messages that have not yet been acknowledged by the broker.\nBrokers now require a client to send an ",["$","code",null,{"children":"puback"}]," package to confirm that it has\nsuccessfully received the package. They also start to keep track of which\nmessages have been delivered to which sessions based on the session identifier,\nso that they can resend the message if a client is not online when a new message\nis published."]}],"\n",["$","p",null,{"children":["It is important to note that, even though it is widely supported, this feature\nof storing messages for offline clients (called session persistence) is not\nrequired for a MQTT-compliant broker. The\n",["$","a",null,{"href":"http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html#_Storing_state","children":"section 4.1 of the standard states"}],"\nthat"]}],"\n",["$","blockquote",null,{"children":["\n",["$","p",null,{"children":"The Client and Server MUST store Session state for the entire duration of the\nSession. A Session MUST last at least as long it has an active Network\nConnection."}],"\n"]}],"\n",["$","p",null,{"children":"Until now, our chat application had the problem that messages can only be\ndelivered when the receiver is online. By using session persistence and QoS 1\nmessages we can make sure that every chat message arrives at the receiver at\nleast once. On the other hand we don't care about redeliveries, because we can\neasily deduplicate the message on the client side, so we don't need QoS 2 (see\nbelow)."}],"\n",["$","p",null,{"children":["If you are running the ",["$","a",null,{"href":"https://github.com/Staff-d/mqtt-chat","children":"demo"}]," application,\nyou can try out this improved implementation of our chat app by navigating to\n",["$","a",null,{"href":"http://localhost:5173/?stage=20","children":["$","code",null,{"children":"http://localhost:5173/?stage=20"}]}]," or check\nthe ",["$","code",null,{"children":"Use QoS 1"}]," checkbox. You can still enter any name to login, but whenever\nyou close a chat window and login again, you will receive all the messages that\nhave been sent to you while you were offline."]}],"\n",["$","video",null,{"controls":true,"preload":"metadata","muted":true,"loop":true,"className":"w-full","children":[["$","source",null,{"src":"/videos/stage-20-fast.webm","type":"video/webm"}],["$","p",null,{"children":"Your browser does not support the video tag."}]]}],"\n",["$","h3",null,{"id":"qos-2-deliver-exactly-once","children":"QoS 2: Deliver Exactly Once"}],"\n",["$","p",null,{"children":"QoS 2 is the strictest of the three QoS levels. At this level, each message is\ndelivered exactly once to every receiver. This is asserted by a two-way\nhandshake that is performed whenever a message is delivered."}],"\n",["$","p",null,{"children":"This quality level is not implemented by many brokers because it is the most\nexpensive in terms of state management. For many MQTT use cases, it also not\nthat useful because the use case can often be modeled with QoS 1 messages and\nclient-side deduplication."}],"\n",["$","h2",null,{"id":"retained-messages","children":"Retained Messages"}],"\n",["$","p",null,{"children":"While publishing a message, a client can specify an additional parameter besides\nthe topic, payload and QoS: the retain flag. If this feature is enabled on the\nbroker and the retain flag is set, the message is stored on the given topic.\nThis means that every client that subscribes to this topic will receive the last\nretained message that has been sent to this topic."}],"\n",["$","p",null,{"children":"It is important to note that retained messages are kept independently of the\nsessions state of the sender, meaning that retained messages are kept even is\nsession state is discarded."}],"\n",["$","p",null,{"children":["In our chat application, we can use retained messages to display the\nonline/offline status of a user. Whenever our client application connects to the\nbroker successfully, we send a message of the following form on the topic\n",["$","code",null,{"children":"chat/status/[username]"}]," using ",["$","strong",null,{"children":"QoS 0"}]," and the retain flag set:"]}],"\n",["$","pre",null,{"className":"language-javascript","children":["$","code",null,{"className":"language-javascript code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token literal-property property","children":"status"}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token string","children":"\"online\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token literal-property property","children":"lastOnlineTimestamp"}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token maybe-class-name","children":"DateTime"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token method function property-access","children":"now"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token method function property-access","children":"toISO"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}]]}]}],"\n",["$","p",null,{"children":"Whenever a user wants to disconnect by clicking the logout button, we switch our\nstatus to offline by publishing:"}],"\n",["$","pre",null,{"className":"language-javascript","children":["$","code",null,{"className":"language-javascript code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token literal-property property","children":"status"}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token string","children":"\"offline\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token literal-property property","children":"lastOnlineTimestamp"}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token maybe-class-name","children":"DateTime"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token method function property-access","children":"now"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token method function property-access","children":"toISO"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}]]}]}],"\n",["$","p",null,{"children":["Now, whenever a client subscribes to the topic ",["$","code",null,{"children":"chat/status/+"}],", they will\nreceive the last status update of every client that is registered with the\nserver. As we only care for the newest status information, we choose QoS 0 for\nthe status messages. With a higher QoS the broker would queue the message for\ndelivery for clients that are offline, which would then receive a boatload of\noutdated status updates when they reconnect. QoS 0 guarantees that older status\nupdates are discarded when a subscriber is offline, and only the newest status\nupdate is delivered when they resubscribe."]}],"\n",["$","h2",null,{"id":"last-will-and-testament-lwt","children":"Last Will And Testament (LWT)"}],"\n",["$","p",null,{"children":["A MQTT client can specify a last will as a part of the ",["$","code",null,{"children":"connect"}]," packet when\nconnecting to the broker. This feature allows a client to request the broker to\nsend one final message should the connection between the two be interrupted\nunexpectedly, for example by a client that crashes or a network outage. A last\nwill consists of everything that is needed to send a normal message: a topic, a\npayload, a QoS level and the retain flag."]}],"\n",["$","p",null,{"children":"However, it is important to note that the LWT only triggers during abnormal\ndisconnects. If a client disconnects in a graceful manner, the LWT will not be\nsent."}],"\n",["$","p",null,{"children":["In our chat application we can use the LWT to make our status feature more\nrobust. Currently, we cannot send a status update to set the status of a user to\n",["$","code",null,{"children":"offline"}]," when a user just closes the browser tab. With LWT, we can fix this\nissue: during connection to the broker, we specify that an ",["$","code",null,{"children":"offline"}]," status\nupdate should be sent to the status topic, with the same parameters (QoS,\nretain) as we would use for a normal status update:"]}],"\n",["$","pre",null,{"className":"language-typescript","children":["$","code",null,{"className":"language-typescript code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token keyword","children":"let"}]," will",["$","span",null,{"className":"token operator","children":":"}]," IClientOptions",["$","span",null,{"className":"token punctuation","children":"["}],["$","span",null,{"className":"token string","children":"\"will\""}],["$","span",null,{"className":"token punctuation","children":"]"}]," ",["$","span",null,{"className":"token operator","children":"|"}]," ",["$","span",null,{"className":"token keyword","children":"undefined"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token keyword","children":"undefined"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token comment","children":"// ..."}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token keyword","children":"const"}]," willMessage",["$","span",null,{"className":"token operator","children":":"}]," WireStatusMessage ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["  status",["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token string","children":"\"offline\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  lastOnlineTimestamp",["$","span",null,{"className":"token operator","children":":"}]," DateTime",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"now"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"toISO"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":["will ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["  topic",["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token template-string","children":[["$","span",null,{"className":"token template-punctuation string","children":"`"}],["$","span",null,{"className":"token string","children":"chat/status/"}],["$","span",null,{"className":"token interpolation","children":[["$","span",null,{"className":"token interpolation-punctuation punctuation","children":"$${"}],"action",["$","span",null,{"className":"token punctuation","children":"."}],"payload",["$","span",null,{"className":"token punctuation","children":"."}],"credentials",["$","span",null,{"className":"token punctuation","children":"."}],"username",["$","span",null,{"className":"token interpolation-punctuation punctuation","children":"}"}]]}],["$","span",null,{"className":"token template-punctuation string","children":"`"}]]}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  payload",["$","span",null,{"className":"token operator","children":":"}]," Buffer",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"from"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token constant","children":"JSON"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function","children":"stringify"}],["$","span",null,{"className":"token punctuation","children":"("}],"willMessage",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  qos",["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token number","children":"0"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  retain",["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token boolean","children":"true"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}]]}]}],"\n",["$","p",null,{"children":"The downside of this approach is that we cannot update the timestamp in the\nstatus message, as the LWT cannot be updated after it was initially set without\ndisconnecting and reconnecting to the broker."}],"\n",["$","p",null,{"children":["The ",["$","a",null,{"href":"https://github.com/Staff-d/mqtt-chat","children":"demo"}]," application provides this\nfeature set with the toggle ",["$","code",null,{"children":"use status messages"}],", available via\n",["$","a",null,{"href":"http://localhost:5173/?stage=30","children":["$","code",null,{"children":"http://localhost:5173/?stage=30"}]}],". Every chat\nshould now display a status badge next to the name of the chat participant that\nupdates whenever a user logs in or out of the app."]}],"\n",["$","video",null,{"controls":true,"preload":"metadata","muted":true,"loop":true,"className":"w-full","children":[["$","source",null,{"src":"/videos/stage-30-fast.webm","type":"video/webm"}],["$","p",null,{"children":"Your browser does not support the video tag."}]]}],"\n",["$","h2",null,{"id":"authentication","children":"Authentication"}],"\n",["$","p",null,{"children":"In the MQTT ecosystem, two kinds of authentication are in widespread use:\nPassword-based and certificate-based authentication."}],"\n",["$","p",null,{"children":"The first one is defined in the MQTT standard: In the initial connect package,\nthe client can include a password and a username. The problem with this approach\nis that both username and password are sent in plaintext, which becomes a\nsecurity liability if as the transport layer is unencrypted too."}],"\n",["$","p",null,{"children":["The second option, which is not standardized but de-facto supported on almost\nevery broker, is to use client-certificates. This approach uses a feature of the\nTLS protocol (so it is only available if MQTT is running on top of TLS, in which\ncase it is often called MQTTS), that requires the TLS client to present a\n",["$","a",null,{"href":"https://en.wikipedia.org/wiki/Transport_Layer_Security#Client-authenticated_TLS_handshake","children":"certificate during the TLS handshake"}],".\nClient certificates are more difficult to set up initially, but can save a lot\nof headache further down the line for two reasons. First, the TLS handshake uses\na challenge mechanism to verify the client certificate, which means that no\nconfidential data is exchanged in plaintext. Second, using client certificates\nrelieves the broker operator from the burden of maintaining the list of\nusername/password pairs at the MQTT broker or, especially in the web application\ncontext where user information might be kept in an external database, from\nsynchronizing it with external data sources. Instead of checking the identity of\neach certificate individually, the broker can use the certificate's chain of\ntrust to verify the validity of the certificate by checking it against the\npublic key of a root certificate that was used to sign the client certificate."]}],"\n",["$","h2",null,{"id":"authorization","children":"Authorization"}],"\n",["$","p",null,{"children":"Until now, a client could just send messages to any MQTT topic, which means that\nthey could easily impersonate another user. With authentication in place, we can\nnow ensure that users can only send messages with themselves as the sender by\ndefining authorization rules."}],"\n",["$","p",null,{"children":["Unfortunately, authorization is not part of the MQTT standard. As stated by\nsection\n",["$","a",null,{"href":"http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html#_Toc385349387","children":"5.4.2 of the standard"}]]}],"\n",["$","blockquote",null,{"children":["\n",["$","p",null,{"children":"An implementation may restrict access to Server resources based on information\nprovided by the Client"}],"\n"]}],"\n",["$","p",null,{"children":"That's all, which is why the following section is mosquitto specific. If you\nneed authorization, check with the broker that you want to use before you start\nusing it."}],"\n",["$","p",null,{"children":["Mosquitto supports reading authorization rules from a file called ",["$","code",null,{"children":"acl_file"}],".\nThis file contains a list of rules of the following form"]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"code-highlight","children":["$","span",null,{"className":"code-line","children":"[pattern|topic] [read|write|readwrite|deny] [topic]\n"}]}]}],"\n",["$","p",null,{"children":[["$","code",null,{"children":"topic"}]," rules can use the same wildcard characters as subscription patterns.\nRules on top of the file will be applied to anonymous clients. Rules can also be\napplied to single username by prefixing a block of rules with a\n",["$","code",null,{"children":"user <username>"}]," line. ",["$","code",null,{"children":"pattern"}],"s on the other hand can contain two additional\nwildcards ",["$","code",null,{"children":"%s"}]," and ",["$","code",null,{"children":"%u"}],". ",["$","code",null,{"children":"%s"}]," is replaced by the session identifier of the\nclient, while ",["$","code",null,{"children":"%u"}]," is replaced with the username that is used in the connect\npackage. Patterns ",["$","strong",null,{"children":"always"}]," apply to all clients."]}],"\n",["$","p",null,{"children":"To make sure that a user can only send messages with themselves as the sender,\nand subscribe only to topics with themselves as the target, we need two rules"}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"code-highlight","children":[["$","span",null,{"className":"code-line","children":"# Patterns affect all clients\n"}],["$","span",null,{"className":"code-line","children":"# Allow clients to read their own messages\n"}],["$","span",null,{"className":"code-line","children":"pattern read chat/messages/%u/+\n"}],["$","span",null,{"className":"code-line","children":"# Allow clients to send messages to other\n"}],["$","span",null,{"className":"code-line","children":"# clients, as long as they use themselves as\n"}],["$","span",null,{"className":"code-line","children":"# the sender\n"}],["$","span",null,{"className":"code-line","children":"pattern write chat/messages/+/%u\n"}]]}]}],"\n",["$","p",null,{"children":"The topics for the status feature can be protected in the same way:"}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"code-highlight","children":[["$","span",null,{"className":"code-line","children":"# Patterns affect all clients\n"}],["$","span",null,{"className":"code-line","children":"# Allow clients to write their own status\n"}],["$","span",null,{"className":"code-line","children":"pattern write chat/status/%u\n"}],["$","span",null,{"className":"code-line","children":"# Allow all clients to read other people's status\n"}],["$","span",null,{"className":"code-line","children":"pattern read chat/status/+\n"}]]}]}],"\n",["$","p",null,{"children":["To illustrate how to use special authorization rules for a single user, I've\nadded a rule that allows the admin user to read all messages for ",["$","em",null,{"children":"compliance"}],"\nreasons:"]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"code-highlight","children":[["$","span",null,{"className":"code-line","children":"# Allow the admin user to read all messages\n"}],["$","span",null,{"className":"code-line","children":"user admin\n"}],["$","span",null,{"className":"code-line","children":"topic read chat/messages/+/+\n"}]]}]}],"\n",["$","p",null,{"children":["In the ",["$","a",null,{"href":"https://github.com/Staff-d/mqtt-chat","children":"demo"}]," application, authorization\nand authentication can be enabled via the ",["$","code",null,{"children":"use authentication"}]," checkbox:\n",["$","a",null,{"href":"http://localhost:5173/?stage=40","children":["$","code",null,{"children":"http://localhost:5173/?stage=40"}]}],". To be able\nto enforce the authorization rules correctly, this switch actually redirects all\ntraffic to a second broker that has authentication enabled."]}],"\n",["$","p",null,{"children":["If we log in as the ",["$","code",null,{"children":"admin"}]," user (password: ",["$","code",null,{"children":"admin"}],") we can now read the\nmessages of all users, while they can only read the messages which are addressed\nto them:"]}],"\n",["$","video",null,{"controls":true,"preload":"metadata","muted":true,"loop":true,"className":"w-full","children":[["$","source",null,{"src":"/videos/stage-40-fast.webm","type":"video/webm"}],["$","p",null,{"children":"Your browser does not support the video tag."}]]}],"\n",["$","p",null,{"children":"With this feature, our simple chat application is completed."}],"\n",["$","h2",null,{"id":"limitations-and-how-to-overcome-them","children":"Limitations and how to overcome them"}],"\n",["$","p",null,{"children":"If you are now considering using MQTT in your own application, you should be\naware of a few common problems that arise in real-world applications that I did\nnot include in my demo application."}],"\n",["$","h3",null,{"id":"ad-hoc-authorization","children":"Ad Hoc authorization"}],"\n",["$","p",null,{"children":"Mosquitto's static, topic-based authorization works well if the topics are known\nin advance, but falls short when the topics are created dynamically."}],"\n",["$","p",null,{"children":["In our chat application, this problem arises when we want to implement chat\ngroups consisting of multiple participants that can be added and removed\ndynamically. Let's assume that we assign an id to every chat room and use a\ntopic of the form ",["$","code",null,{"children":"chat/room/[room_id]"}]," to distribute messages to the group."]}],"\n",["$","p",null,{"children":"As Mosquitto keeps the authorization rules in a file, we would need to update\nthis file and reload the configuration whenever the membership of a chat room\nchanges."}],"\n",["$","p",null,{"children":["The Mosquitto ecosystem offers two plugins that solve this problem: The\n",["$","a",null,{"href":"https://mosquitto.org/documentation/dynamic-security/","children":"dynamic security plugin"}],"\noffers an API via a magic MQTT topic to update the authorization rules at\nruntime and introduces additional concepts such as roles and groups. These\nrules, however, are stored in a JSON file and require other applications to use\nMQTT as well or use the included cli application to update the rules."]}],"\n",["$","p",null,{"children":["Another option that is better suited for more complex applications is\n",["$","a",null,{"href":"https://github.com/iegomez/mosquitto-go-auth","children":"mosquitto-go-auth"}]," which offers\nthe option to store the authorization rules in a database like postgres, redis,\nor mongoDB, which can be accessed and maintained by external applications."]}],"\n",["$","h3",null,{"id":"data-validation","children":"Data Validation"}],"\n",["$","p",null,{"children":"One of the most common issues that arise when implementing MQTT in a real-life,\nuser-facing application is the need to validate the messages that are sent to a\nspecific topic. This is something that a typical MQTT broker cannot do out of\nthe box, but there are common patterns to overcome this limitation."}],"\n",["$","p",null,{"children":"Let's stick with our chat example: Assume that we maintain a blacklist of\nforbidden words that may not be sent via our application. Checking against this\nlist only on the frontend side would allow a user to connect to our broker via a\ndifferent MQTT client and send messages containing forbidden words anyways, so\nthis solution won't cut it."}],"\n",["$","p",null,{"children":["One Pattern that is, for example, employed by the\n",["$","a",null,{"href":"https://docs.aws.amazon.com/iot/latest/developerguide/device-shadow-mqtt.html#:r2j:","children":"AWS IoT Core"}],",\nis to split the single chat topic into multiple smaller ones:\n",["$","code",null,{"children":"chat/[receiver]/[sender]/request"}]," for message send requests,\n",["$","code",null,{"children":"chat/[receiver]/[sender]/accepted"}]," for messages that pass the blacklist check\nand ",["$","code",null,{"children":"chat/[receiver]/[sender]/rejected"}]," for messages that don't. We now need to\nchange the authorization rules as follows to allow message senders to publish\nnew chat messages only to the ",["$","code",null,{"children":"/request"}]," topic and subscribe to the ",["$","code",null,{"children":"/rejected"}],"\ntopic to receive feedback on their messages. Message receivers can subscribe to\nthe ",["$","code",null,{"children":"/accepted"}]," topic to receive only those messages that have passed the\nblacklist check:"]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"code-highlight","children":[["$","span",null,{"className":"code-line","children":"# Permissions for chat users\n"}],["$","span",null,{"className":"code-line","children":"pattern read chat/messages/%u/+/accepted\n"}],["$","span",null,{"className":"code-line","children":"pattern write chat/messages/+/%u/request\n"}],["$","span",null,{"className":"code-line","children":"pattern write chat/messages/+/%u/rejected\n"}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":"# Permissions for the backend app\n"}],["$","span",null,{"className":"code-line","children":"# that has to perform the blacklist check\n"}],["$","span",null,{"className":"code-line","children":"user backend\n"}],["$","span",null,{"className":"code-line","children":"topic read chat/messages/+/+/request\n"}],["$","span",null,{"className":"code-line","children":"topic write chat/messages/+/+/accepted\n"}],["$","span",null,{"className":"code-line","children":"topic write chat/messages/+/+/rejected\n"}]]}]}],"\n",["$","p",null,{"children":["The check against the blacklist has to be performed by a custom-built worker,\nauthorized by the username ",["$","code",null,{"children":"backend"}],", running on a server somewhere. This worker\nsubscribes to the ",["$","code",null,{"children":"/request"}]," topic and publishes the messages to the ",["$","code",null,{"children":"/accepted"}],"\nor ",["$","code",null,{"children":"/rejected"}]," topic, depending on the result of the check against the\nblacklist. It is important to note, however, that every message that is sent on\nany chat topic now has to pass through this worker. This might not be a problem\nwhen checking against a static blacklist, but depending on the complexity of the\ncheck (which might contain calls to a datastore), might create a bottleneck in\nour application."]}],"\n",["$","h2",null,{"id":"use-case-examples","children":"Use Case Examples"}],"\n",["$","p",null,{"children":"To conclude this article I wanted to present a few more applications that could\nbe implemented using MQTT, but didn't make the cut to be selected for my demo\napplication:"}],"\n",["$","h3",null,{"id":"newsticker-app","children":"Newsticker App"}],"\n",["$","p",null,{"children":["Publishes new articles to a hierarchy of topics that represent the different\ncategories of the news, e.g. ",["$","code",null,{"children":"news/politics/us/utah"}],",",["$","code",null,{"children":"news/politics/europe"}],",\n",["$","code",null,{"children":"news/sport/football"}],", ",["$","code",null,{"children":"news/sport/formula-1"}],". Clients can subscribe to the\ncategories that are most interesting to them either directly, or by using\nwildcards like ",["$","code",null,{"children":"news/sport/#"}]," to get all sport news."]}],"\n",["$","h3",null,{"id":"progress-reporting","children":"Progress Reporting"}],"\n",["$","p",null,{"children":"Useful for long-running, asynchronous tasks that are performed by a worker. The\nworker publishes progress updates as retained messages to a topic that is unique\nto the task. This way, whenever a client subscribes to the progress topic, they\nwould get the newest progress update immediately as well as all future updates."}],"\n",["$","h3",null,{"id":"real-time-online-auctions","children":"Real Time Online Auctions"}],"\n",["$","p",null,{"children":["Auctioneers can publish new items to a topic that is unique to the auction.\nClients can subscribe to the wildcard topic ",["$","code",null,{"children":"auctions/#"}]," to get all new items\nthat are up for auction. Bids could be placed by addressing the item topic\ndirectly, e.g. ",["$","code",null,{"children":"auctions/1234/bid"}],", but would have to be verified by using a\nbackend worker as described in the ",["$","a",null,{"href":"#data-validation","children":"data validation chapter"}],"\nto make sure that the bid is higher than the current highest bid. Successful\nbids would be published on the original auction topic as a retained message, so\nthat all clients that are interested in the item would get the newest bid\nimmediately."]}],"\n",["$","h2",null,{"id":"further-reading","children":"Further Reading"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["$","a",null,{"href":"http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html","children":"MQTT 3.1.1 Specification"}]}],"\n",["$","li",null,{"children":["$","a",null,{"href":"https://mosquitto.org/man/mosquitto-conf-5.html","children":"Mosquitto Configuration Options"}]}],"\n",["$","li",null,{"children":["$","a",null,{"href":"https://www.hivemq.com/blog/mqtt-essentials-part-4-mqtt-publish-subscribe-unsubscribe/","children":"HiveMQ MQTT Essentials Blog Series"}]}],"\n",["$","li",null,{"children":["$","a",null,{"href":"https://www.emqx.com/en/blog/category/mqtt-protocol","children":"emqx MQTT Tutorial Series"}]}],"\n"]}],"\n",["$","p",null,{"children":["If you are interested in MQTT, you'll quickly encounter MQTT5. This article uses\nMQTT 3.1.1 features only, as the changes in MQTT5 are not relevant for the use\ncases described here. If you want to learn more about MQTT5 and you already have\na firm grasp of what MQTT 3.1.1 can do, I recommend the\n",["$","a",null,{"href":"https://www.hivemq.com/mqtt/mqtt-5/","children":"HiveMQ MQTT5 writeup"}],"."]}],"\n",["$","h2",null,{"id":"about-the-header-image","children":"About the header Image"}],"\n",["$","p",null,{"children":"Created with OpenAIs GPT-4o on 2024-11-15. Prompt:"}],"\n",["$","blockquote",null,{"children":["\n",["$","p",null,{"children":"Create an image of a cellular tower in a happy mood. Use a comic style. Do not\nshow the faces of people."}],"\n"]}]]
16:["$","section",null,{"className":"w-full py-12 md:py-24 lg:py-32 bg-gray-100 dark:bg-gray-800","children":["$","div",null,{"className":"container px-4 md:px-6 mx-auto","children":[["$","h2",null,{"className":"text-3xl font-bold tracking-tighter sm:text-5xl text-center mb-4 md:mb-6","children":"More posts like this one"}],["$","div",null,{"className":"grid gap-6 md:grid-cols-2 lg:grid-cols-3","children":[["$","div","note-on-nixos-handeling-feedback",{"ref":"$undefined","className":"rounded-xl border bg-card text-card-foreground shadow flex flex-col justify-between","children":[["$","div",null,{"ref":"$undefined","className":"flex flex-col space-y-1.5 p-6","children":[["$","h3",null,{"ref":"$undefined","className":"font-semibold leading-none tracking-tight","children":["$","$L4",null,{"href":"/posts/note-on-nixos-handeling-feedback","children":"Note: NixOS Feedback Handling"}]}],["$","div",null,{"className":"flex items-center space-x-1 text-sm text-gray-500","children":[["$","svg",null,{"ref":"$undefined","xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-calendar h-4 w-4","children":[["$","path","1cmpym",{"d":"M8 2v4"}],["$","path","4m81vk",{"d":"M16 2v4"}],["$","rect","1hopcy",{"width":"18","height":"18","x":"3","y":"4","rx":"2"}],["$","path","8toen8",{"d":"M3 10h18"}],"$undefined"]}],["$","time",null,{"dateTime":"2025-01-13T13:26:51.295Z","children":"Jan 13, 2025, 2:26 PM"}]]}]]}],["$","div",null,{"ref":"$undefined","className":"p-6 pt-0","children":["$","p",null,{"children":"A quick, positive example on how a project can handle critical feedback"}]}],["$","div",null,{"ref":"$undefined","className":"items-center p-6 pt-0 flex justify-between","children":[["$","p",null,{"className":"text-sm text-gray-500","children":["By ","Sebastian Staffa"]}],["$","$L4",null,{"href":"/posts/note-on-nixos-handeling-feedback","children":["$","button",null,{"className":"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 text-primary underline-offset-4 hover:underline h-9 px-4 py-2","ref":"$undefined","children":["Read More",["$","svg",null,{"ref":"$undefined","xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-chevron-right ml-2 h-4 w-4","children":[["$","path","mthhwq",{"d":"m9 18 6-6-6-6"}],"$undefined"]}]]}]}]]}]]}],["$","div","minimal-lambda-containers-with-nix",{"ref":"$undefined","className":"rounded-xl border bg-card text-card-foreground shadow flex flex-col justify-between","children":[["$","div",null,{"ref":"$undefined","className":"flex flex-col space-y-1.5 p-6","children":[["$","h3",null,{"ref":"$undefined","className":"font-semibold leading-none tracking-tight","children":["$","$L4",null,{"href":"/posts/minimal-lambda-containers-with-nix","children":"Improving Median Lambda Init Times By 23%"}]}],["$","div",null,{"className":"flex items-center space-x-1 text-sm text-gray-500","children":[["$","svg",null,{"ref":"$undefined","xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-calendar h-4 w-4","children":[["$","path","1cmpym",{"d":"M8 2v4"}],["$","path","4m81vk",{"d":"M16 2v4"}],["$","rect","1hopcy",{"width":"18","height":"18","x":"3","y":"4","rx":"2"}],["$","path","8toen8",{"d":"M3 10h18"}],"$undefined"]}],["$","time",null,{"dateTime":"2024-12-09T11:56:02.178Z","children":"Dec 9, 2024, 12:56 PM"}]]}]]}],["$","div",null,{"ref":"$undefined","className":"p-6 pt-0","children":["$","p",null,{"children":"In today's post we are improving the cold start times of a Node.js Lambda function by building our own runtime image using Nix."}]}],["$","div",null,{"ref":"$undefined","className":"items-center p-6 pt-0 flex justify-between","children":[["$","p",null,{"className":"text-sm text-gray-500","children":["By ","Sebastian Staffa"]}],["$","$L4",null,{"href":"/posts/minimal-lambda-containers-with-nix","children":["$","button",null,{"className":"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 text-primary underline-offset-4 hover:underline h-9 px-4 py-2","ref":"$undefined","children":["Read More",["$","svg",null,{"ref":"$undefined","xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-chevron-right ml-2 h-4 w-4","children":[["$","path","mthhwq",{"d":"m9 18 6-6-6-6"}],"$undefined"]}]]}]}]]}]]}],["$","div","nixos-as-a-freelancer",{"ref":"$undefined","className":"rounded-xl border bg-card text-card-foreground shadow flex flex-col justify-between","children":[["$","div",null,{"ref":"$undefined","className":"flex flex-col space-y-1.5 p-6","children":[["$","h3",null,{"ref":"$undefined","className":"font-semibold leading-none tracking-tight","children":["$","$L4",null,{"href":"/posts/nixos-as-a-freelancer","children":"As a freelancer, I put my trust in NixOS. Here's why."}]}],["$","div",null,{"className":"flex items-center space-x-1 text-sm text-gray-500","children":[["$","svg",null,{"ref":"$undefined","xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-calendar h-4 w-4","children":[["$","path","1cmpym",{"d":"M8 2v4"}],["$","path","4m81vk",{"d":"M16 2v4"}],["$","rect","1hopcy",{"width":"18","height":"18","x":"3","y":"4","rx":"2"}],["$","path","8toen8",{"d":"M3 10h18"}],"$undefined"]}],["$","time",null,{"dateTime":"2024-11-07T10:11:08.169Z","children":"Nov 7, 2024, 11:11 AM"}]]}]]}],["$","div",null,{"ref":"$undefined","className":"p-6 pt-0","children":["$","p",null,{"children":"In today's blog I want to talk about why I have chosen NixOS as my main operating system."}]}],["$","div",null,{"ref":"$undefined","className":"items-center p-6 pt-0 flex justify-between","children":[["$","p",null,{"className":"text-sm text-gray-500","children":["By ","Sebastian Staffa"]}],["$","$L4",null,{"href":"/posts/nixos-as-a-freelancer","children":["$","button",null,{"className":"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 text-primary underline-offset-4 hover:underline h-9 px-4 py-2","ref":"$undefined","children":["Read More",["$","svg",null,{"ref":"$undefined","xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-chevron-right ml-2 h-4 w-4","children":[["$","path","mthhwq",{"d":"m9 18 6-6-6-6"}],"$undefined"]}]]}]}]]}]]}]]}]]}]}]
e:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
c:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"MQTT For Web Developers"}],["$","meta","2",{"name":"description","content":"MQTT is a protocol that is typically used in an IoT context. In this article, we'll explore how we could use its capabilities in a traditional web application to stream messages in real-time."}]]
a:null
