1:"$Sreact.fragment"
2:I[99676,["/_next/static/chunks/7c5ef281d3c6aa1b.js","/_next/static/chunks/ef763e11ad9b2e12.js","/_next/static/chunks/0a277c514b971790.js","/_next/static/chunks/f7d70d96044b0f34.js"],"Avatar"]
3:I[99676,["/_next/static/chunks/7c5ef281d3c6aa1b.js","/_next/static/chunks/ef763e11ad9b2e12.js","/_next/static/chunks/0a277c514b971790.js","/_next/static/chunks/f7d70d96044b0f34.js"],"AvatarImage"]
4:I[99676,["/_next/static/chunks/7c5ef281d3c6aa1b.js","/_next/static/chunks/ef763e11ad9b2e12.js","/_next/static/chunks/0a277c514b971790.js","/_next/static/chunks/f7d70d96044b0f34.js"],"AvatarFallback"]
5:I[5500,["/_next/static/chunks/7c5ef281d3c6aa1b.js","/_next/static/chunks/ef763e11ad9b2e12.js","/_next/static/chunks/0a277c514b971790.js","/_next/static/chunks/f7d70d96044b0f34.js"],"Image"]
6:I[52157,["/_next/static/chunks/7c5ef281d3c6aa1b.js","/_next/static/chunks/ef763e11ad9b2e12.js","/_next/static/chunks/0a277c514b971790.js","/_next/static/chunks/f7d70d96044b0f34.js"],"PreloadChunks"]
4a:I[22016,["/_next/static/chunks/7c5ef281d3c6aa1b.js","/_next/static/chunks/ef763e11ad9b2e12.js","/_next/static/chunks/0a277c514b971790.js","/_next/static/chunks/f7d70d96044b0f34.js"],""]
4d:I[97367,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/6153d1a363729c2c.js"],"OutletBoundary"]
4e:"$Sreact.suspense"
0:{"buildId":"6Ky4R6Bkx7NelPiZjM_hQ","rsc":["$","$1","c",{"children":[["$","main",null,{"className":"flex-1","children":[["$","script",null,{"type":"application/ld+json","suppressHydrationWarning":true,"dangerouslySetInnerHTML":{"__html":"{\"@context\":\"https://schema.org\",\"@type\":\"BlogPosting\",\"headline\":\"Building nvidia-docker containers with nix\",\"datePublished\":\"2020-03-09T20:33:10+01:00\",\"dateModified\":\"2020-03-09T20:33:10+01:00\",\"description\":\"A practical guide on how to package your cuda dependent application build with nix into a docker container.\",\"image\":\"https://sebastian-staffa.eu/images/gpu-container-header.webp\",\"url\":\"https://sebastian-staffa.eu/posts/nvidia-docker-with-nix\",\"author\":{\"@type\":\"Person\",\"name\":\"Sebastian Staffa\"}}"}}],["$","article",null,{"className":"container max-w-3xl px-4 py-6 lg:py-12 mx-auto","children":[["$","h1",null,{"className":"text-3xl font-bold tracking-tighter sm:text-4xl md:text-5xl lg:text-6xl/none mb-4","children":"Building nvidia-docker containers with nix"}],false,["$","div",null,{"className":"flex items-center space-x-4 mb-4","children":[["$","$L2",null,{"children":[["$","$L3",null,{"src":"/_next/static/media/portrait-ico.088aff86.webp","alt":"Avatar of Sebastian Staffa"}],["$","$L4",null,{"children":"S"}]]}],["$","div",null,{"children":[["$","p",null,{"className":"text-sm font-medium","children":"Sebastian Staffa"}],["$","p",null,{"className":"text-sm text-gray-500 flex flex-row align-baseline","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-calendar inline-block w-4 h-4 mr-1","children":[["$","path","1cmpym",{"d":"M8 2v4"}],["$","path","4m81vk",{"d":"M16 2v4"}],["$","rect","1hopcy",{"width":"18","height":"18","x":"3","y":"4","rx":"2"}],["$","path","8toen8",{"d":"M3 10h18"}],"$undefined"]}],"Published on"," ","Mar 9, 2020, 8:33 PM"]}]]}]]}],["$","$L5",null,{"src":{"src":"/_next/static/media/gpu-container-header.05e95d6b.webp","width":1080,"height":485,"blurWidth":8,"blurHeight":4,"blurDataURL":"data:image/webp;base64,UklGRtoAAABXRUJQVlA4TM0AAAAvB8AAAM1VICICHgjACQQAAABppoBEBIAAAAAAAAAAAAAAAAAAAAAADwAAAAHIoCAEAhAVeIIDAADwQABIAAAAAM4fWP79gDe8YQAwAGA7AAAAAAAAAAAAMAAAYAAAAAAM2ACGAWDzQABOIAAAAM7/RAiIFwAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAtNGHbJPZIr8+NQTA6WFwdPtc1DQGB5FktVJBEuRTWOUf7WaTU/kl+aiQW0ZssLq8NQn/lU/5bwurx/nZHVsfAA=="},"alt":"Photo by Tri Eptaroka Mardiana on Unsplash; The NixOS logo is licensed under the Creative Commons Attribution 4.0 International License","className":"rounded-lg object-cover w-full mb-8","priority":true}],["$","div",null,{"className":"prose max-w-none","children":[["$","$L6",null,{}],[["$","p",null,{"children":"How to convert the output of a derivation into a self contained package is one\nof the most important questions when developing productive Software with nix,\neven for prototype applications. If the system you need to deploy to is not\nunder your control, nix is probably not installed and will not be in the\nimmediate future."}],"\n",["$","p",null,{"children":["To avoid having to beg an admin I don't even know personally to install nix on\nsome remote system I have no root access to, I usually just\n",["$","a",null,{"href":"https://nixos.org/nixpkgs/manual/#sec-pkgs-dockerTools","children":"build a docker container"}],".\nDocker is, as of today, a tool most sys admins know and trust, and if it isn't\ninstalled already it shouldn't be a problem to convince them to do so. At least\nif you want to deploy server applications that is, but you can always use\n",["$","a",null,{"href":"https://nixos.org/nixpkgs/manual/#sec-pkgs-appimageTools","children":"AppImages"}]," as a\nreplacement if you need to deploy user applications."]}],"\n",["$","h2",null,{"id":"background-deploying-cuda-based-apps","children":"Background: Deploying CUDA based apps"}],"\n","$L7","\n","$L8","\n","$L9","\n","$La","\n","$Lb","\n","$Lc","\n","$Ld","\n","$Le","\n","$Lf","\n","$L10","\n","$L11","\n","$L12","\n","$L13","\n","$L14","\n","$L15","\n","$L16","\n","$L17","\n","$L18","\n","$L19","\n","$L1a","\n","$L1b","\n","$L1c","\n","$L1d","\n","$L1e"]]}]]}],"$L1f"]}],["$L20","$L21"],"$L22"]}],"loading":null,"isPartial":false}
7:["$","p",null,{"children":["So when I was tasked to deploy a machine learning system to a gpu cluster\nrunning Nvidia GPUs, building a docker container was again my go-to solution. I\nalready knew that I would need to convince the admin to install\n",["$","a",null,{"href":"https://github.com/NVIDIA/nvidia-docker","children":"nvidia-docker"}]," (link to\n",["$","a",null,{"href":"https://github.com/NixOS/nixpkgs/blob/db3e8325a9b62b2b4fad0342f6835cb4ccc80c9b/pkgs/applications/virtualization/nvidia-docker/default.nix","children":"nixpkgs"}],"),\na docker runtime which exposes host GPUs to the containers running on it, but\nthis was the lesser problem."]}]
8:["$","p",null,{"children":["CUDA itself, a widely used, proprietary library used for various computations on\nNvidia GPUs, is\n",["$","a",null,{"href":"https://github.com/NixOS/nixpkgs/blob/db3e8325a9b62b2b4fad0342f6835cb4ccc80c9b/pkgs/development/compilers/cudatoolkit/default.nix","children":"already available in the nixpkgs"}],"\nand used in derivations which have gpu support enabled like the machine learning\nlibrary\n",["$","a",null,{"href":"https://github.com/NixOS/nixpkgs/blob/db3e8325a9b62b2b4fad0342f6835cb4ccc80c9b/pkgs/development/python-modules/pytorch/default.nix","children":"pytorch"}],"\n(even though you'll have to bring some patience if you want to use libraries\nwith cuda support, as they are unfree packages and\n",["$","a",null,{"href":"https://nixos.wiki/wiki/FAQ#More_precision","children":"thus not available in the public nix binary cache"}],")."]}]
9:["$","p",null,{"children":"At first, I thought it would be an easy task: Sit through the waiting times on\nmy development machine to build all necessary libs with cuda support once (as\nthey are available in your local nix store afterwards), write a 20 line\nderivation to put everything into a vanilla container and that's it."}]
a:["$","p",null,{"children":"As you may have guessed by the length of the article (or the query that most\nlikely brought you here), this was not \"it\". What follows is a summary of the\nthings I needed to do to get nvidia-cuda containers made with nix to work."}]
b:["$","h2",null,{"id":"prerequisites","children":"Prerequisites"}]
c:["$","p",null,{"children":"I assume that you have a working derivation (as in: it compiles and does the\nstuff you want it to do) with a dependency on cuda, which needs to be deployed\non a non NixOS Linux operating system."}]
d:["$","p",null,{"children":["If you struggle to get the derivation to work on you own system (without docker\ninvolved), I'd point you over to this\n",["$","a",null,{"href":"https://github.com/cdepillabout/course-v3/blob/6ecf90f640f327dc05b167f45fb7ba88bc265281/default.nix#L251","children":"derivation"}],"\nwhich builds fast.ai (a machine learning lib build on top of the aforementioned\npytorch) to get some inspiration on how to write a working wrapper for cuda\napplications."]}]
e:["$","p",null,{"children":"As a first step you should make sure that all subderivations of your final\nderivation depend on the same version of cuda."}]
f:["$","p",null,{"children":["In theory multiple versions of cuda should not be a problem, but I got some very\nconsistent crashes of the nvidia-containers when they were present. I suspect\nthis is a issue on the driver-side. At least it should be easy to\n",["$","a",null,{"href":"https://nixos.org/nixpkgs/manual/#sec-pkg-overrideAttrs","children":"overwrite"}]," versions\ndiffering from the one you want to use."]}]
10:["$","p",null,{"children":"Also, make sure that the driver on your target host system supports the cuda\nversion you want to use, as this driver will later process the calls from your\ndocker container."}]
11:["$","h2",null,{"id":"a-few-technical-details","children":"A few technical details"}]
12:["$","p",null,{"children":["First it is important to note that - in theory - every possible container can be\nused with GPU support, as the\n",["$","a",null,{"href":"https://github.com/NVIDIA/nvidia-docker/wiki/Installation-(Native-GPU-Support)#non-cuda-image","children":"nvidia-docker wiki states"}],"."]}]
13:["$","p",null,{"children":["This implies that no modifications to the layers of the container have to be\nmade in order to make it run on the GPU. This is confirmed by the README of the\nunderlying\n",["$","a",null,{"href":"https://github.com/NVIDIA/nvidia-container-runtime/tree/d95ffa54f4aec56532d1ad6350d641bc034a776f#nvidia-container-runtime","children":"nvidia-container-runtime"}],",\nwhich states that the container runtime only adds a\n",["$","a",null,{"href":"https://github.com/opencontainers/runtime-spec/blob/master/config.md#posix-platform-hooks","children":"pre-start hook"}],"\nwhen a container is run."]}]
14:["$","p",null,{"children":"What we have to do though is to set the correct environment variables. This is\nthe reason why extending the cuda base image from the docker hub does not work\nwhen using the nix docker-tools - the docker-tools clear the environment of the\ncontainer before adding any additional layers."}]
15:["$","p",null,{"children":["You can find a list of ",["$","em",null,{"children":"most"}]," relevant environment variables over at the\n",["$","a",null,{"href":"https://github.com/NVIDIA/nvidia-container-runtime/tree/d95ffa54f4aec56532d1ad6350d641bc034a776f#environment-variables-oci-spec","children":"container-runtime repository"}],"\nbut this list is not complete."]}]
16:["$","p",null,{"children":"As the runtime preStart hook mount the driver and library files of the host\nsystem into your container you`ll have to specify where the program loader can\nfind the shared libraries requiered by your cuda application."}]
17:["$","p",null,{"children":["One way to do this is to set the ",["$","code",null,{"children":"LD_LIBRARY_PATH"}]," environment variable to the\npath where the nvidia-runtime will mount them (which seems to be ",["$","code",null,{"children":"/usr/lib64/"}],",\nbut I am certain there are more). You could also specify the files to load\ndirectly using the ",["$","code",null,{"children":"LD_PRELOAD"}]," variable and there are most certainly even more\nways."]}]
18:["$","h2",null,{"id":"solution","children":"Solution"}]
19:["$","p",null,{"children":["A generic nix build to build nvidia-docker container is available over at\n",["$","a",null,{"href":"https://github.com/Staff-d/nix-cuda-docker-example","children":"Github"}]," and below. The git\nalso included a small demo application which is build using three versions of\nCUDA to create three different docker images, so you can see it in action."]}]
1a:["$","pre",null,{"className":"language-nix","children":["$","code",null,{"className":"language-nix code-highlight","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token comment","children":"# see https://github.com/NixOS/nixpkgs/blob/0a351c3f65136c00d3512dd77f48e12a571cf495/pkgs/build-support/docker/default.nix#L656"}],"\n"]}],["$","span",null,{"className":"code-line","children":["  cudatoolkit",["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  buildImage",["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  lib",["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  name",["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  tag ",["$","span",null,{"className":"token operator","children":"?"}]," ",["$","span",null,{"className":"token keyword","children":"null"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  fromImage ",["$","span",null,{"className":"token operator","children":"?"}]," ",["$","span",null,{"className":"token keyword","children":"null"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  fromImageName ",["$","span",null,{"className":"token operator","children":"?"}]," ",["$","span",null,{"className":"token keyword","children":"null"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  fromImageTag ",["$","span",null,{"className":"token operator","children":"?"}]," ",["$","span",null,{"className":"token keyword","children":"null"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  contents ",["$","span",null,{"className":"token operator","children":"?"}]," ",["$","span",null,{"className":"token keyword","children":"null"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  keepContentsDirlinks ",["$","span",null,{"className":"token operator","children":"?"}]," ",["$","span",null,{"className":"token boolean","children":"false"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  config ",["$","span",null,{"className":"token operator","children":"?"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"Env ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"["}],["$","span",null,{"className":"token punctuation","children":"]"}],["$","span",null,{"className":"token punctuation","children":";"}],["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  extraCommands ",["$","span",null,{"className":"token operator","children":"?"}]," ",["$","span",null,{"className":"token string","children":"\"\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  uid ",["$","span",null,{"className":"token operator","children":"?"}]," ",["$","span",null,{"className":"token number","children":"0"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  gid ",["$","span",null,{"className":"token operator","children":"?"}]," ",["$","span",null,{"className":"token number","children":"0"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  runAsRoot ",["$","span",null,{"className":"token operator","children":"?"}]," ",["$","span",null,{"className":"token keyword","children":"null"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  diskSize ",["$","span",null,{"className":"token operator","children":"?"}]," ",["$","span",null,{"className":"token number","children":"1024"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["  created ",["$","span",null,{"className":"token operator","children":"?"}]," ","$L23","$L24","\n"]}],"$L25","$L26","$L27","$L28","$L29","$L2a","$L2b","$L2c","$L2d","$L2e","$L2f","$L30","$L31","$L32","$L33","$L34","$L35","$L36","$L37","$L38","$L39","$L3a","$L3b","$L3c","$L3d","$L3e","$L3f","$L40","$L41","$L42","$L43","$L44","$L45","$L46","$L47","$L48","$L49"]}]}]
1b:["$","p",null,{"children":["As you can see, the builder is a wrapper for docker builder, which adds the\nrequired environment variables. The builder isn't perfect though. As your driver\nversion is dependent on the host system, it will not work on all machines - the\nexample I uploaded to github assumes your driver supports at least CUDA 10.0,\nbut you could downgrade this anytime. A perfect solutions would include fetching\nand using the correct driver for a given CUDA version, but we hit\n",["$","a",null,{"href":"https://www.reddit.com/r/NixOS/comments/5p7mk1/can_nix_handle_lowlevel_dependencies_like/","children":"end of the road here"}]," -\n(at least for now)."]}]
1c:["$","p",null,{"children":["A simple solution one could use to at least give a immediate and readable error\nmessage if the host CUDA version is too low is to set the\n",["$","a",null,{"href":"https://github.com/NVIDIA/nvidia-container-runtime/tree/d95ffa54f4aec56532d1ad6350d641bc034a776f#nvidia_require_","children":["NVIDIA",["$","em",null,{"children":"REQUIRE"}],"*"]}],"\nenvironment variable. I may include this in the builder if I find the time and\nupdate the git accordingly."]}]
1d:["$","h2",null,{"id":"credits","children":"Credits"}]
1e:["$","ul",null,{"children":["\n",["$","li",null,{"children":["Dennis Gossnel's\n",["$","a",null,{"href":"https://functor.tokyo/blog/2019-03-16-nix-derivation-for-fastai","children":"Nix Derivation for fast.ai"}],",\nwhich I used as a primer to get nix to build something with cuda support"]}],"\n",["$","li",null,{"children":[["$","a",null,{"href":"https://blog.galowicz.de/","children":"tfc"}],"'s\n",["$","a",null,{"href":"https://github.com/tfc/nix_cmake_example","children":"Nix Cmake Example"}],", which I use as\na kind of reference work whenever I forget how to do something with Nix."]}],"\n",["$","li",null,{"children":"Cover Photo by Tri Eptaroka Mardiana on Unsplash; The NixOS logo is licensed\nunder the Creative Commons Attribution 4.0 International License"}],"\n"]}]
1f:["$","section",null,{"className":"w-full py-12 md:py-24 lg:py-32 bg-gray-100 dark:bg-gray-800","children":["$","div",null,{"className":"container px-4 md:px-6 mx-auto","children":[["$","h2",null,{"className":"text-3xl font-bold tracking-tighter sm:text-5xl text-center mb-4 md:mb-6","children":"More posts like this one"}],["$","div",null,{"className":"grid gap-6 md:grid-cols-2 lg:grid-cols-3","children":[["$","div","nodejs-native-ts-benchmark",{"className":"rounded-xl border bg-card text-card-foreground shadow flex flex-col justify-between","children":[["$","div",null,{"className":"flex flex-col space-y-1.5 p-6","children":[["$","h3",null,{"className":"font-semibold leading-none tracking-tight","children":["$","$L4a",null,{"href":"/posts/nodejs-native-ts-benchmark","children":"A look at native TypeScript performance"}]}],["$","div",null,{"className":"flex items-center space-x-1 text-sm text-gray-500","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-calendar h-4 w-4","children":[["$","path","1cmpym",{"d":"M8 2v4"}],["$","path","4m81vk",{"d":"M16 2v4"}],["$","rect","1hopcy",{"width":"18","height":"18","x":"3","y":"4","rx":"2"}],["$","path","8toen8",{"d":"M3 10h18"}],"$undefined"]}],["$","time",null,{"dateTime":"2025-02-24T14:32:53.120Z","children":"Feb 24, 2025, 3:32 PM"}]]}]]}],["$","div",null,{"className":"p-6 pt-0","children":["$","p",null,{"children":"Node.js 23.6.0 dropped the experimental flag for native TypeScript support. Let's see how it performs when running TS natively."}]}],["$","div",null,{"className":"items-center p-6 pt-0 flex justify-between","children":[["$","p",null,{"className":"text-sm text-gray-500","children":["By ","Sebastian Staffa"]}],["$","$L4a",null,{"href":"/posts/nodejs-native-ts-benchmark","children":["$","button",null,{"className":"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 text-primary underline-offset-4 hover:underline h-9 px-4 py-2","children":["Read More",["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-chevron-right ml-2 h-4 w-4","children":[["$","path","mthhwq",{"d":"m9 18 6-6-6-6"}],"$undefined"]}]]}]}]]}]]}],["$","div","note-on-nixos-handeling-feedback",{"className":"rounded-xl border bg-card text-card-foreground shadow flex flex-col justify-between","children":[["$","div",null,{"className":"flex flex-col space-y-1.5 p-6","children":[["$","h3",null,{"className":"font-semibold leading-none tracking-tight","children":["$","$L4a",null,{"href":"/posts/note-on-nixos-handeling-feedback","children":"Note: NixOS Feedback Handling"}]}],["$","div",null,{"className":"flex items-center space-x-1 text-sm text-gray-500","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-calendar h-4 w-4","children":[["$","path","1cmpym",{"d":"M8 2v4"}],["$","path","4m81vk",{"d":"M16 2v4"}],["$","rect","1hopcy",{"width":"18","height":"18","x":"3","y":"4","rx":"2"}],["$","path","8toen8",{"d":"M3 10h18"}],"$undefined"]}],["$","time",null,{"dateTime":"2025-01-13T13:26:51.295Z","children":"Jan 13, 2025, 2:26 PM"}]]}]]}],["$","div",null,{"className":"p-6 pt-0","children":["$","p",null,{"children":"A quick, positive example on how a project can handle critical feedback"}]}],["$","div",null,{"className":"items-center p-6 pt-0 flex justify-between","children":[["$","p",null,{"className":"text-sm text-gray-500","children":["By ","Sebastian Staffa"]}],["$","$L4a",null,{"href":"/posts/note-on-nixos-handeling-feedback","children":["$","button",null,{"className":"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 text-primary underline-offset-4 hover:underline h-9 px-4 py-2","children":["Read More","$L4b"]}]}]]}]]}],"$L4c"]}]]}]}]
20:["$","script","script-0",{"src":"/_next/static/chunks/0a277c514b971790.js","async":true}]
21:["$","script","script-1",{"src":"/_next/static/chunks/f7d70d96044b0f34.js","async":true}]
22:["$","$L4d",null,{"children":["$","$4e",null,{"name":"Next.MetadataOutlet","children":"$@4f"}]}]
23:["$","span",null,{"className":"token string","children":"\"1970-01-01T00:00:01Z\""}]
24:["$","span",null,{"className":"token punctuation","children":","}]
25:["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":":"}]," ",["$","span",null,{"className":"token keyword","children":"let"}],"\n"]}]
26:["$","span",null,{"className":"code-line","children":["  cutVersion ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token keyword","children":"with"}]," lib",["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}]
27:["$","span",null,{"className":"code-line","children":["    versionString",["$","span",null,{"className":"token punctuation","children":":"}],"\n"]}]
28:["$","span",null,{"className":"code-line","children":["      ",["$","span",null,{"className":"token keyword","children":"builtins"}],["$","span",null,{"className":"token punctuation","children":"."}],"concatStringsSep ",["$","span",null,{"className":"token string","children":"\".\""}],"\n"]}]
29:["$","span",null,{"className":"code-line","children":["      ",["$","span",null,{"className":"token punctuation","children":"("}],"\n"]}]
2a:["$","span",null,{"className":"code-line","children":["        take ",["$","span",null,{"className":"token number","children":"3"}]," ",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token keyword","children":"builtins"}],["$","span",null,{"className":"token punctuation","children":"."}],"splitVersion versionString",["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}]
2b:["$","span",null,{"className":"code-line","children":["      ",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}]
2c:["$","span",null,{"className":"code-line","children":"\n"}]
2d:["$","span",null,{"className":"code-line","children":["  cudaVersionString ",["$","span",null,{"className":"token operator","children":"="}],"\n"]}]
2e:["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token string","children":"\"CUDA_VERSION=\""}]," ",["$","span",null,{"className":"token operator","children":"+"}]," ",["$","span",null,{"className":"token punctuation","children":"("}],"cutVersion cudatoolkit",["$","span",null,{"className":"token punctuation","children":"."}],"version",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}]
2f:["$","span",null,{"className":"code-line","children":"\n"}]
30:["$","span",null,{"className":"code-line","children":["  cudaEnv ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"["}],"\n"]}]
31:["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token string","children":["\"",["$","span",null,{"className":"token interpolation","children":[["$","span",null,{"className":"token antiquotation important","children":"$$"}],["$","span",null,{"className":"token punctuation","children":"{"}],"cudaVersionString",["$","span",null,{"className":"token punctuation","children":"}"}]]}],"\""]}],"\n"]}]
32:["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token string","children":"\"NVIDIA_VISIBLE_DEVICES=all\""}],"\n"]}]
33:["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token string","children":"\"NVIDIA_DRIVER_CAPABILITIES=all\""}],"\n"]}]
34:["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token string","children":"\"LD_LIBRARY_PATH=/usr/lib64/\""}],"\n"]}]
35:["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token punctuation","children":"]"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}]
36:["$","span",null,{"className":"code-line","children":"\n"}]
37:["$","span",null,{"className":"code-line","children":["  cudaConfig ",["$","span",null,{"className":"token operator","children":"="}]," config ",["$","span",null,{"className":"token operator","children":"//"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"Env ",["$","span",null,{"className":"token operator","children":"="}]," cudaEnv",["$","span",null,{"className":"token punctuation","children":";"}],["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}]
38:["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token keyword","children":"in"}],"\n"]}]
39:["$","span",null,{"className":"code-line","children":["  buildImage ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}]
3a:["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token keyword","children":"inherit"}],"\n"]}]
3b:["$","span",null,{"className":"code-line","children":"      name\n"}]
3c:["$","span",null,{"className":"code-line","children":"      tag\n"}]
3d:["$","span",null,{"className":"code-line","children":"      fromImage\n"}]
3e:["$","span",null,{"className":"code-line","children":"      fromImageName\n"}]
3f:["$","span",null,{"className":"code-line","children":"      fromImageTag\n"}]
40:["$","span",null,{"className":"code-line","children":"      contents\n"}]
41:["$","span",null,{"className":"code-line","children":"      keepContentsDirlinks\n"}]
42:["$","span",null,{"className":"code-line","children":"      extraCommands\n"}]
43:["$","span",null,{"className":"code-line","children":"      runAsRoot\n"}]
44:["$","span",null,{"className":"code-line","children":"      diskSize\n"}]
45:["$","span",null,{"className":"code-line","children":"      created\n"}]
46:["$","span",null,{"className":"code-line","children":["      ",["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}]
47:["$","span",null,{"className":"code-line","children":"\n"}]
48:["$","span",null,{"className":"code-line","children":["    config ",["$","span",null,{"className":"token operator","children":"="}]," cudaConfig",["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}]
49:["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}]
4b:["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-chevron-right ml-2 h-4 w-4","children":[["$","path","mthhwq",{"d":"m9 18 6-6-6-6"}],"$undefined"]}]
4c:["$","div","minimal-lambda-containers-with-nix",{"className":"rounded-xl border bg-card text-card-foreground shadow flex flex-col justify-between","children":[["$","div",null,{"className":"flex flex-col space-y-1.5 p-6","children":[["$","h3",null,{"className":"font-semibold leading-none tracking-tight","children":["$","$L4a",null,{"href":"/posts/minimal-lambda-containers-with-nix","children":"Improving Median Lambda Init Times By 23%"}]}],["$","div",null,{"className":"flex items-center space-x-1 text-sm text-gray-500","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-calendar h-4 w-4","children":[["$","path","1cmpym",{"d":"M8 2v4"}],["$","path","4m81vk",{"d":"M16 2v4"}],["$","rect","1hopcy",{"width":"18","height":"18","x":"3","y":"4","rx":"2"}],["$","path","8toen8",{"d":"M3 10h18"}],"$undefined"]}],["$","time",null,{"dateTime":"2024-12-09T11:56:02.178Z","children":"Dec 9, 2024, 12:56 PM"}]]}]]}],["$","div",null,{"className":"p-6 pt-0","children":["$","p",null,{"children":"In today's post we are improving the cold start times of a Node.js Lambda function by building our own runtime image using Nix."}]}],["$","div",null,{"className":"items-center p-6 pt-0 flex justify-between","children":[["$","p",null,{"className":"text-sm text-gray-500","children":["By ","Sebastian Staffa"]}],["$","$L4a",null,{"href":"/posts/minimal-lambda-containers-with-nix","children":["$","button",null,{"className":"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 text-primary underline-offset-4 hover:underline h-9 px-4 py-2","children":["Read More",["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-chevron-right ml-2 h-4 w-4","children":[["$","path","mthhwq",{"d":"m9 18 6-6-6-6"}],"$undefined"]}]]}]}]]}]]}]
4f:null
